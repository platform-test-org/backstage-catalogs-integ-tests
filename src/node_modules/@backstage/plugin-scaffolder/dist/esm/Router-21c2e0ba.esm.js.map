{"version":3,"file":"Router-21c2e0ba.esm.js","sources":["../../src/components/TemplateCard/TemplateCard.tsx","../../src/components/TemplateList/TemplateList.tsx","../../src/components/ScaffolderPage/ScaffolderPageContextMenu.tsx","../../src/components/ScaffolderPage/ScaffolderPage.tsx","../../src/components/MultistepJsonForm/schema.ts","../../src/components/MultistepJsonForm/FieldOverrides/DescriptionField.tsx","../../src/components/MultistepJsonForm/MultistepJsonForm.tsx","../../src/components/TemplatePage/createValidator.ts","../../src/components/TemplatePage/TemplatePage.tsx","../../src/components/ActionsPage/ActionsPage.tsx","../../src/lib/filesystem/WebFileSystemAccess.ts","../../src/components/TemplateEditorPage/TemplateEditorIntro.tsx","../../src/components/TemplateEditorPage/DirectoryEditorContext.tsx","../../src/components/TemplateEditorPage/DryRunContext.tsx","../../src/components/TemplateEditorPage/DryRunResults/DryRunResultsList.tsx","../../src/components/FileBrowser/FileBrowser.tsx","../../src/components/TemplateEditorPage/DryRunResults/DryRunResultsSplitView.tsx","../../src/components/TemplateEditorPage/DryRunResults/DryRunResultsView.tsx","../../src/components/TemplateEditorPage/DryRunResults/DryRunResults.tsx","../../src/components/TemplateEditorPage/TemplateEditorBrowser.tsx","../../src/components/TemplateEditorPage/TemplateEditorForm.tsx","../../src/components/TemplateEditorPage/TemplateEditorTextArea.tsx","../../src/components/TemplateEditorPage/TemplateEditor.tsx","../../src/components/TemplateEditorPage/TemplateFormPreviewer.tsx","../../src/components/TemplateEditorPage/TemplateEditorPage.tsx","../../src/components/ListTasksPage/OwnerListPicker.tsx","../../src/components/ListTasksPage/columns/CreatedAtColumn.tsx","../../src/components/ListTasksPage/columns/OwnerEntityColumn.tsx","../../src/components/ListTasksPage/columns/TaskStatusColumn.tsx","../../src/components/ListTasksPage/columns/TemplateTitleColumn.tsx","../../src/components/ListTasksPage/ListTasksPage.tsx","../../src/components/Router.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  DEFAULT_NAMESPACE,\n  Entity,\n  EntityLink,\n  parseEntityRef,\n  RELATION_OWNED_BY,\n  stringifyEntityRef,\n} from '@backstage/catalog-model';\nimport {\n  Button,\n  ItemCardHeader,\n  Link,\n  MarkdownContent,\n} from '@backstage/core-components';\nimport {\n  IconComponent,\n  useApi,\n  useApp,\n  useRouteRef,\n} from '@backstage/core-plugin-api';\nimport {\n  ScmIntegrationIcon,\n  scmIntegrationsApiRef,\n} from '@backstage/integration-react';\nimport {\n  EntityRefLinks,\n  FavoriteEntity,\n  getEntityRelations,\n  getEntitySourceLocation,\n} from '@backstage/plugin-catalog-react';\nimport { TemplateEntityV1beta3 } from '@backstage/plugin-scaffolder-common';\nimport { BackstageTheme } from '@backstage/theme';\nimport {\n  Box,\n  Card,\n  CardActions,\n  CardContent,\n  CardMedia,\n  Chip,\n  IconButton,\n  makeStyles,\n  Tooltip,\n  Typography,\n  useTheme,\n} from '@material-ui/core';\nimport LanguageIcon from '@material-ui/icons/Language';\nimport WarningIcon from '@material-ui/icons/Warning';\nimport React from 'react';\nimport { selectedTemplateRouteRef, viewTechDocRouteRef } from '../../routes';\n\nconst useStyles = makeStyles(theme => ({\n  cardHeader: {\n    position: 'relative',\n  },\n  title: {\n    backgroundImage: ({ backgroundImage }: any) => backgroundImage,\n  },\n  box: {\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    display: '-webkit-box',\n    '-webkit-line-clamp': 10,\n    '-webkit-box-orient': 'vertical',\n  },\n  label: {\n    color: theme.palette.text.secondary,\n    textTransform: 'uppercase',\n    fontSize: '0.65rem',\n    fontWeight: 'bold',\n    letterSpacing: 0.5,\n    lineHeight: 1,\n    paddingBottom: '0.2rem',\n  },\n  linksLabel: {\n    padding: '0 16px',\n  },\n  description: {\n    '& p': {\n      margin: '0px',\n    },\n  },\n  leftButton: {\n    marginRight: 'auto',\n  },\n  starButton: {\n    position: 'absolute',\n    top: theme.spacing(0.5),\n    right: theme.spacing(0.5),\n    padding: '0.25rem',\n    color: '#fff',\n  },\n}));\n\nconst MuiIcon = ({ icon: Icon }: { icon: IconComponent }) => <Icon />;\n\nconst useDeprecationStyles = makeStyles(theme => ({\n  deprecationIcon: {\n    position: 'absolute',\n    top: theme.spacing(0.5),\n    right: theme.spacing(3.5),\n    padding: '0.25rem',\n  },\n  link: {\n    color: theme.palette.warning.light,\n  },\n}));\n\nexport type TemplateCardProps = {\n  template: TemplateEntityV1beta3;\n  deprecated?: boolean;\n};\n\ntype TemplateProps = {\n  description: string;\n  tags: string[];\n  title: string;\n  type: string;\n  name: string;\n  links: EntityLink[];\n};\n\nconst getTemplateCardProps = (\n  template: TemplateEntityV1beta3,\n): TemplateProps & { key: string } => {\n  return {\n    key: template.metadata.uid!,\n    name: template.metadata.name,\n    title: `${(template.metadata.title || template.metadata.name) ?? ''}`,\n    type: template.spec.type ?? '',\n    description: template.metadata.description ?? '-',\n    tags: (template.metadata?.tags as string[]) ?? [],\n    links: template.metadata.links ?? [],\n  };\n};\n\nconst DeprecationWarning = () => {\n  const styles = useDeprecationStyles();\n\n  const Title = (\n    <Typography style={{ padding: 10, maxWidth: 300 }}>\n      This template uses a syntax that has been deprecated, and should be\n      migrated to a newer syntax. Click for more info.\n    </Typography>\n  );\n\n  return (\n    <div className={styles.deprecationIcon}>\n      <Tooltip title={Title}>\n        <Link\n          to=\"https://backstage.io/docs/features/software-templates/migrating-from-v1beta2-to-v1beta3\"\n          className={styles.link}\n        >\n          <WarningIcon />\n        </Link>\n      </Tooltip>\n    </div>\n  );\n};\n\nexport const TemplateCard = ({ template, deprecated }: TemplateCardProps) => {\n  const app = useApp();\n  const backstageTheme = useTheme<BackstageTheme>();\n  const templateRoute = useRouteRef(selectedTemplateRouteRef);\n  const templateProps = getTemplateCardProps(template);\n  const ownedByRelations = getEntityRelations(\n    template as Entity,\n    RELATION_OWNED_BY,\n  );\n  const themeId = backstageTheme.getPageTheme({ themeId: templateProps.type })\n    ? templateProps.type\n    : 'other';\n  const theme = backstageTheme.getPageTheme({ themeId });\n  const classes = useStyles({ backgroundImage: theme.backgroundImage });\n  const { name, namespace } = parseEntityRef(stringifyEntityRef(template));\n  const href = templateRoute({ templateName: name, namespace });\n\n  // TechDocs Link\n  const viewTechDoc = useRouteRef(viewTechDocRouteRef);\n  const viewTechDocsAnnotation =\n    template.metadata.annotations?.['backstage.io/techdocs-ref'];\n  const viewTechDocsLink =\n    !!viewTechDocsAnnotation &&\n    !!viewTechDoc &&\n    viewTechDoc({\n      namespace: template.metadata.namespace || DEFAULT_NAMESPACE,\n      kind: template.kind,\n      name: template.metadata.name,\n    });\n\n  const iconResolver = (key?: string): IconComponent =>\n    key ? app.getSystemIcon(key) ?? LanguageIcon : LanguageIcon;\n\n  const scmIntegrationsApi = useApi(scmIntegrationsApiRef);\n  const sourceLocation = getEntitySourceLocation(template, scmIntegrationsApi);\n\n  return (\n    <Card>\n      <CardMedia className={classes.cardHeader}>\n        <FavoriteEntity className={classes.starButton} entity={template} />\n        {deprecated && <DeprecationWarning />}\n        <ItemCardHeader\n          title={templateProps.title}\n          subtitle={templateProps.type}\n          classes={{ root: classes.title }}\n        />\n      </CardMedia>\n      <CardContent\n        style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}\n      >\n        <Box className={classes.box}>\n          <Typography variant=\"body2\" className={classes.label}>\n            Description\n          </Typography>\n          <MarkdownContent\n            className={classes.description}\n            content={templateProps.description}\n          />\n        </Box>\n        <Box className={classes.box}>\n          <Typography variant=\"body2\" className={classes.label}>\n            Owner\n          </Typography>\n          <EntityRefLinks entityRefs={ownedByRelations} defaultKind=\"Group\" />\n        </Box>\n        <Box>\n          <Typography\n            style={{ marginBottom: '4px' }}\n            variant=\"body2\"\n            className={classes.label}\n          >\n            Tags\n          </Typography>\n          {templateProps.tags?.map(tag => (\n            <Chip size=\"small\" label={tag} key={tag} />\n          ))}\n        </Box>\n      </CardContent>\n      <Typography\n        variant=\"body2\"\n        className={[classes.label, classes.linksLabel].join(' ')}\n      >\n        Links\n      </Typography>\n      <CardActions>\n        <div className={classes.leftButton}>\n          {sourceLocation && (\n            <Tooltip\n              title={\n                sourceLocation.integrationType ||\n                sourceLocation.locationTargetUrl\n              }\n            >\n              <IconButton\n                className={classes.leftButton}\n                href={sourceLocation.locationTargetUrl}\n              >\n                <ScmIntegrationIcon type={sourceLocation.integrationType} />\n              </IconButton>\n            </Tooltip>\n          )}\n          {viewTechDocsLink && (\n            <Tooltip title=\"View TechDocs\">\n              <IconButton\n                className={classes.leftButton}\n                href={viewTechDocsLink}\n              >\n                <MuiIcon icon={iconResolver('docs')} />\n              </IconButton>\n            </Tooltip>\n          )}\n          {templateProps.links?.map((link, i) => (\n            <Tooltip key={`${link.url}_${i}`} title={link.title || link.url}>\n              <IconButton size=\"medium\" href={link.url}>\n                <MuiIcon icon={iconResolver(link.icon)} />\n              </IconButton>\n            </Tooltip>\n          ))}\n        </div>\n        <Button\n          color=\"primary\"\n          to={href}\n          aria-label={`Choose ${templateProps.title}`}\n        >\n          Choose\n        </Button>\n      </CardActions>\n    </Card>\n  );\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ComponentType } from 'react';\nimport { Entity, stringifyEntityRef } from '@backstage/catalog-model';\nimport { TemplateEntityV1beta3 } from '@backstage/plugin-scaffolder-common';\nimport {\n  Content,\n  ContentHeader,\n  ItemCardGrid,\n  Link,\n  Progress,\n  WarningPanel,\n} from '@backstage/core-components';\nimport { useEntityList } from '@backstage/plugin-catalog-react';\nimport { Typography } from '@material-ui/core';\nimport { TemplateCard } from '../TemplateCard';\n\n/**\n * @internal\n */\nexport type TemplateListProps = {\n  TemplateCardComponent?:\n    | ComponentType<{ template: TemplateEntityV1beta3 }>\n    | undefined;\n  group?: {\n    title?: React.ReactNode;\n    filter: (entity: Entity) => boolean;\n  };\n};\n\n/**\n * @internal\n */\nexport const TemplateList = ({\n  TemplateCardComponent,\n  group,\n}: TemplateListProps) => {\n  const { loading, error, entities } = useEntityList();\n  const Card = TemplateCardComponent || TemplateCard;\n  const maybeFilteredEntities = group\n    ? entities.filter(e => group.filter(e))\n    : entities;\n\n  const titleComponent: React.ReactNode = (() => {\n    if (group && group.title) {\n      if (typeof group.title === 'string') {\n        return <ContentHeader title={group.title} />;\n      }\n      return group.title;\n    }\n\n    return <ContentHeader title=\"Other Templates\" />;\n  })();\n\n  if (group && maybeFilteredEntities.length === 0) {\n    return null;\n  }\n  return (\n    <>\n      {loading && <Progress />}\n\n      {error && (\n        <WarningPanel title=\"Oops! Something went wrong loading the templates\">\n          {error.message}\n        </WarningPanel>\n      )}\n\n      {!error && !loading && !entities.length && (\n        <Typography variant=\"body2\">\n          No templates found that match your filter. Learn more about{' '}\n          <Link to=\"https://backstage.io/docs/features/software-templates/adding-templates\">\n            adding templates\n          </Link>\n          .\n        </Typography>\n      )}\n\n      <Content>\n        {titleComponent}\n        <ItemCardGrid>\n          {maybeFilteredEntities &&\n            maybeFilteredEntities?.length > 0 &&\n            maybeFilteredEntities.map((template: Entity) => (\n              <Card\n                key={stringifyEntityRef(template)}\n                template={template as TemplateEntityV1beta3}\n                deprecated={template.apiVersion === 'backstage.io/v1beta2'}\n              />\n            ))}\n        </ItemCardGrid>\n      </Content>\n    </>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useRouteRef } from '@backstage/core-plugin-api';\nimport IconButton from '@material-ui/core/IconButton';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport Popover from '@material-ui/core/Popover';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Description from '@material-ui/icons/Description';\nimport Edit from '@material-ui/icons/Edit';\nimport List from '@material-ui/icons/List';\nimport MoreVert from '@material-ui/icons/MoreVert';\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router';\nimport {\n  actionsRouteRef,\n  editRouteRef,\n  scaffolderListTaskRouteRef,\n} from '../../routes';\n\nconst useStyles = makeStyles({\n  button: {\n    color: 'white',\n  },\n});\n\nexport type ScaffolderPageContextMenuProps = {\n  editor?: boolean;\n  actions?: boolean;\n  tasks?: boolean;\n};\n\nexport function ScaffolderPageContextMenu(\n  props: ScaffolderPageContextMenuProps,\n) {\n  const classes = useStyles();\n  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement>();\n  const editLink = useRouteRef(editRouteRef);\n  const actionsLink = useRouteRef(actionsRouteRef);\n  const tasksLink = useRouteRef(scaffolderListTaskRouteRef);\n\n  const navigate = useNavigate();\n\n  const showEditor = props.editor !== false;\n  const showActions = props.actions !== false;\n  const showTasks = props.tasks !== false;\n\n  if (!showEditor && !showActions) {\n    return null;\n  }\n\n  const onOpen = (event: React.SyntheticEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const onClose = () => {\n    setAnchorEl(undefined);\n  };\n\n  return (\n    <>\n      <IconButton\n        aria-label=\"more\"\n        aria-controls=\"long-menu\"\n        aria-haspopup=\"true\"\n        onClick={onOpen}\n        data-testid=\"menu-button\"\n        color=\"inherit\"\n        className={classes.button}\n      >\n        <MoreVert />\n      </IconButton>\n      <Popover\n        open={Boolean(anchorEl)}\n        onClose={onClose}\n        anchorEl={anchorEl}\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\n        transformOrigin={{ vertical: 'top', horizontal: 'right' }}\n      >\n        <MenuList>\n          {showEditor && (\n            <MenuItem onClick={() => navigate(editLink())}>\n              <ListItemIcon>\n                <Edit fontSize=\"small\" />\n              </ListItemIcon>\n              <ListItemText primary=\"Template Editor\" />\n            </MenuItem>\n          )}\n          {showActions && (\n            <MenuItem onClick={() => navigate(actionsLink())}>\n              <ListItemIcon>\n                <Description fontSize=\"small\" />\n              </ListItemIcon>\n              <ListItemText primary=\"Installed Actions\" />\n            </MenuItem>\n          )}\n          {showTasks && (\n            <MenuItem onClick={() => navigate(tasksLink())}>\n              <ListItemIcon>\n                <List fontSize=\"small\" />\n              </ListItemIcon>\n              <ListItemText primary=\"Task List\" />\n            </MenuItem>\n          )}\n        </MenuList>\n      </Popover>\n    </>\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Content,\n  ContentHeader,\n  CreateButton,\n  Header,\n  Page,\n  SupportButton,\n} from '@backstage/core-components';\nimport { Entity } from '@backstage/catalog-model';\nimport { TemplateEntityV1beta3 } from '@backstage/plugin-scaffolder-common';\nimport { useRouteRef } from '@backstage/core-plugin-api';\nimport {\n  CatalogFilterLayout,\n  EntityKindPicker,\n  EntityListProvider,\n  EntitySearchBar,\n  EntityTagPicker,\n  UserListPicker,\n} from '@backstage/plugin-catalog-react';\nimport React, { ComponentType } from 'react';\nimport { registerComponentRouteRef } from '../../routes';\nimport { TemplateList } from '../TemplateList';\nimport { TemplateTypePicker } from '../TemplateTypePicker';\nimport { catalogEntityCreatePermission } from '@backstage/plugin-catalog-common';\nimport { usePermission } from '@backstage/plugin-permission-react';\nimport { ScaffolderPageContextMenu } from './ScaffolderPageContextMenu';\n\nexport type ScaffolderPageProps = {\n  TemplateCardComponent?:\n    | ComponentType<{ template: TemplateEntityV1beta3 }>\n    | undefined;\n  groups?: Array<{\n    title?: React.ReactNode;\n    filter: (entity: Entity) => boolean;\n  }>;\n  contextMenu?: {\n    editor?: boolean;\n    actions?: boolean;\n    tasks?: boolean;\n  };\n  headerOptions?: {\n    pageTitleOverride?: string;\n    title?: string;\n    subtitle?: string;\n  };\n};\n\nexport const ScaffolderPageContents = ({\n  TemplateCardComponent,\n  groups,\n  contextMenu,\n  headerOptions,\n}: ScaffolderPageProps) => {\n  const registerComponentLink = useRouteRef(registerComponentRouteRef);\n  const otherTemplatesGroup = {\n    title: groups ? 'Other Templates' : 'Templates',\n    filter: (entity: Entity) => {\n      const filtered = (groups ?? []).map(group => group.filter(entity));\n      return !filtered.some(result => result === true);\n    },\n  };\n\n  const { allowed } = usePermission({\n    permission: catalogEntityCreatePermission,\n  });\n\n  return (\n    <Page themeId=\"home\">\n      <Header\n        pageTitleOverride=\"Create a New Component\"\n        title=\"Create a New Component\"\n        subtitle=\"Create new software components using standard templates\"\n        {...headerOptions}\n      >\n        <ScaffolderPageContextMenu {...contextMenu} />\n      </Header>\n      <Content>\n        <ContentHeader title=\"Available Templates\">\n          {allowed && (\n            <CreateButton\n              title=\"Register Existing Component\"\n              to={registerComponentLink && registerComponentLink()}\n            />\n          )}\n          <SupportButton>\n            Create new software components using standard templates. Different\n            templates create different kinds of components (services, websites,\n            documentation, ...).\n          </SupportButton>\n        </ContentHeader>\n\n        <CatalogFilterLayout>\n          <CatalogFilterLayout.Filters>\n            <EntitySearchBar />\n            <EntityKindPicker initialFilter=\"template\" hidden />\n            <UserListPicker\n              initialFilter=\"all\"\n              availableFilters={['all', 'starred']}\n            />\n            <TemplateTypePicker />\n            <EntityTagPicker />\n          </CatalogFilterLayout.Filters>\n          <CatalogFilterLayout.Content>\n            {groups &&\n              groups.map((group, index) => (\n                <TemplateList\n                  key={index}\n                  TemplateCardComponent={TemplateCardComponent}\n                  group={group}\n                />\n              ))}\n            <TemplateList\n              key=\"other\"\n              TemplateCardComponent={TemplateCardComponent}\n              group={otherTemplatesGroup}\n            />\n          </CatalogFilterLayout.Content>\n        </CatalogFilterLayout>\n      </Content>\n    </Page>\n  );\n};\n\nexport const ScaffolderPage = ({\n  TemplateCardComponent,\n  groups,\n  contextMenu,\n  headerOptions,\n}: ScaffolderPageProps) => (\n  <EntityListProvider>\n    <ScaffolderPageContents\n      TemplateCardComponent={TemplateCardComponent}\n      groups={groups}\n      contextMenu={contextMenu}\n      headerOptions={headerOptions}\n    />\n  </EntityListProvider>\n);\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { JsonObject } from '@backstage/types';\nimport { FormProps, UiSchema } from '@rjsf/core';\nimport { LayoutOptions } from '../../layouts';\n\nfunction isObject(value: unknown): value is JsonObject {\n  return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\n\nfunction extractUiSchema(schema: JsonObject, uiSchema: JsonObject) {\n  if (!isObject(schema)) {\n    return;\n  }\n\n  const { properties, items, anyOf, oneOf, allOf, dependencies } = schema;\n\n  for (const propName in schema) {\n    if (!schema.hasOwnProperty(propName)) {\n      continue;\n    }\n\n    if (propName.startsWith('ui:')) {\n      uiSchema[propName] = schema[propName];\n      delete schema[propName];\n    }\n  }\n\n  if (isObject(properties)) {\n    for (const propName in properties) {\n      if (!properties.hasOwnProperty(propName)) {\n        continue;\n      }\n\n      const schemaNode = properties[propName];\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      const innerUiSchema = {};\n      uiSchema[propName] = uiSchema[propName] || innerUiSchema;\n      extractUiSchema(schemaNode, innerUiSchema);\n    }\n  }\n\n  if (isObject(items)) {\n    const innerUiSchema = {};\n    uiSchema.items = innerUiSchema;\n    extractUiSchema(items, innerUiSchema);\n  }\n\n  if (Array.isArray(anyOf)) {\n    for (const schemaNode of anyOf) {\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      extractUiSchema(schemaNode, uiSchema);\n    }\n  }\n\n  if (Array.isArray(oneOf)) {\n    for (const schemaNode of oneOf) {\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      extractUiSchema(schemaNode, uiSchema);\n    }\n  }\n\n  if (Array.isArray(allOf)) {\n    for (const schemaNode of allOf) {\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      extractUiSchema(schemaNode, uiSchema);\n    }\n  }\n\n  if (isObject(dependencies)) {\n    for (const depName of Object.keys(dependencies)) {\n      const schemaNode = dependencies[depName];\n      if (!isObject(schemaNode)) {\n        continue;\n      }\n      extractUiSchema(schemaNode, uiSchema);\n    }\n  }\n}\n\nexport function transformSchemaToProps(\n  inputSchema: JsonObject,\n  layouts: LayoutOptions[] = [],\n): {\n  schema: FormProps<any>['schema'];\n  uiSchema: FormProps<any>['uiSchema'];\n} {\n  const customLayoutName = inputSchema['ui:ObjectFieldTemplate'];\n  inputSchema.type = inputSchema.type || 'object';\n  const schema = JSON.parse(JSON.stringify(inputSchema));\n  delete schema.title; // Rendered separately\n  const uiSchema: UiSchema = {};\n  extractUiSchema(schema, uiSchema);\n\n  if (customLayoutName) {\n    const Layout = layouts.find(\n      layout => layout.name === customLayoutName,\n    )?.component;\n\n    if (Layout) {\n      uiSchema['ui:ObjectFieldTemplate'] = Layout;\n    }\n  }\n\n  return { schema, uiSchema };\n}\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { MarkdownContent } from '@backstage/core-components';\nimport { FieldProps } from '@rjsf/core';\n\nexport const DescriptionField = ({ description }: FieldProps) =>\n  description && <MarkdownContent content={description} linkTarget=\"_blank\" />;\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { JsonObject } from '@backstage/types';\nimport {\n  Box,\n  Button,\n  Paper,\n  Step as StepUI,\n  StepContent,\n  StepLabel,\n  Stepper,\n  Typography,\n} from '@material-ui/core';\nimport {\n  errorApiRef,\n  useApi,\n  featureFlagsApiRef,\n  useAnalytics,\n  useRouteRefParams,\n} from '@backstage/core-plugin-api';\nimport { FormProps, IChangeEvent, UiSchema, withTheme } from '@rjsf/core';\nimport { Theme as MuiTheme } from '@rjsf/material-ui';\nimport React, { useState } from 'react';\nimport { transformSchemaToProps } from './schema';\nimport { Content, StructuredMetadataTable } from '@backstage/core-components';\nimport cloneDeep from 'lodash/cloneDeep';\nimport * as fieldOverrides from './FieldOverrides';\nimport { LayoutOptions } from '../../layouts';\nimport { selectedTemplateRouteRef } from '../../routes';\n\nconst Form = withTheme(MuiTheme);\ntype Step = {\n  schema: JsonObject;\n  title: string;\n} & Partial<Omit<FormProps<any>, 'schema'>>;\n\ntype Props = {\n  /**\n   * Steps for the form, each contains title and form schema\n   */\n  steps: Step[];\n  formData: Record<string, any>;\n  onChange: (e: IChangeEvent) => void;\n  onReset: () => void;\n  onFinish?: () => Promise<void>;\n  widgets?: FormProps<any>['widgets'];\n  fields?: FormProps<any>['fields'];\n  finishButtonLabel?: string;\n  layouts: LayoutOptions[];\n};\n\nexport function getUiSchemasFromSteps(steps: Step[]): UiSchema[] {\n  const uiSchemas: Array<UiSchema> = [];\n  steps.forEach(step => {\n    const schemaProps = step.schema.properties as JsonObject;\n    for (const key in schemaProps) {\n      if (schemaProps.hasOwnProperty(key)) {\n        const uiSchema = schemaProps[key] as UiSchema;\n        uiSchema.name = key;\n        uiSchemas.push(uiSchema);\n      }\n    }\n  });\n  return uiSchemas;\n}\n\nexport function getReviewData(formData: Record<string, any>, steps: Step[]) {\n  const uiSchemas = getUiSchemasFromSteps(steps);\n  const reviewData: Record<string, any> = {};\n  for (const key in formData) {\n    if (formData.hasOwnProperty(key)) {\n      const uiSchema = uiSchemas.find(us => us.name === key);\n\n      if (!uiSchema) {\n        reviewData[key] = formData[key];\n        continue;\n      }\n\n      if (uiSchema['ui:widget'] === 'password') {\n        reviewData[key] = '******';\n        continue;\n      }\n\n      if (!uiSchema['ui:backstage'] || !uiSchema['ui:backstage'].review) {\n        reviewData[key] = formData[key];\n        continue;\n      }\n\n      const review = uiSchema['ui:backstage'].review as JsonObject;\n      if (review.mask) {\n        reviewData[key] = review.mask;\n        continue;\n      }\n\n      if (!review.show) {\n        continue;\n      }\n      reviewData[key] = formData[key];\n    }\n  }\n\n  return reviewData;\n}\n\nexport const MultistepJsonForm = (props: Props) => {\n  const {\n    formData,\n    onChange,\n    onReset,\n    onFinish,\n    fields,\n    widgets,\n    finishButtonLabel,\n    layouts,\n  } = props;\n  const { templateName } = useRouteRefParams(selectedTemplateRouteRef);\n  const analytics = useAnalytics();\n  const [activeStep, setActiveStep] = useState(0);\n  const [disableButtons, setDisableButtons] = useState(false);\n  const errorApi = useApi(errorApiRef);\n  const featureFlagApi = useApi(featureFlagsApiRef);\n  const featureFlagKey = 'backstage:featureFlag';\n  const filterOutProperties = (step: Step): Step => {\n    const filteredStep = cloneDeep(step);\n    const removedPropertyKeys: Array<string> = [];\n    if (filteredStep.schema.properties) {\n      filteredStep.schema.properties = Object.fromEntries(\n        Object.entries(filteredStep.schema.properties).filter(\n          ([key, value]) => {\n            if (value[featureFlagKey]) {\n              if (featureFlagApi.isActive(value[featureFlagKey])) {\n                return true;\n              }\n              removedPropertyKeys.push(key);\n              return false;\n            }\n            return true;\n          },\n        ),\n      );\n\n      // remove the feature flag property key from required if they are not active\n      filteredStep.schema.required = Array.isArray(filteredStep.schema.required)\n        ? filteredStep.schema.required?.filter(\n            r => !removedPropertyKeys.includes(r as string),\n          )\n        : filteredStep.schema.required;\n    }\n    return filteredStep;\n  };\n\n  const steps = props.steps\n    .filter(step => {\n      const featureFlag = step.schema[featureFlagKey];\n      return (\n        typeof featureFlag !== 'string' || featureFlagApi.isActive(featureFlag)\n      );\n    })\n    .map(filterOutProperties);\n\n  const handleReset = () => {\n    setActiveStep(0);\n    onReset();\n  };\n  const handleNext = () => {\n    const stepNum = Math.min(activeStep + 1, steps.length);\n    setActiveStep(stepNum);\n    analytics.captureEvent('click', `Next Step (${stepNum})`);\n  };\n  const handleBack = () => setActiveStep(Math.max(activeStep - 1, 0));\n  const handleCreate = async () => {\n    if (!onFinish) {\n      return;\n    }\n\n    setDisableButtons(true);\n    try {\n      await onFinish();\n      analytics.captureEvent('create', formData.name || `new ${templateName}`);\n    } catch (err) {\n      errorApi.post(err);\n    } finally {\n      setDisableButtons(false);\n    }\n  };\n\n  return (\n    <>\n      <Stepper activeStep={activeStep} orientation=\"vertical\">\n        {steps.map(({ title, schema, ...formProps }, index) => {\n          return (\n            <StepUI key={title}>\n              <StepLabel\n                aria-label={`Step ${index + 1} ${title}`}\n                aria-disabled=\"false\"\n                tabIndex={0}\n              >\n                <Typography variant=\"h6\" component=\"h3\">\n                  {title}\n                </Typography>\n              </StepLabel>\n              <StepContent key={title}>\n                <Form\n                  showErrorList={false}\n                  fields={{ ...fieldOverrides, ...fields }}\n                  widgets={widgets}\n                  noHtml5Validate\n                  formData={formData}\n                  formContext={{ formData }}\n                  onChange={onChange}\n                  onSubmit={e => {\n                    if (e.errors.length === 0) handleNext();\n                  }}\n                  {...formProps}\n                  {...transformSchemaToProps(schema, layouts)}\n                >\n                  <Button disabled={activeStep === 0} onClick={handleBack}>\n                    Back\n                  </Button>\n                  <Button variant=\"contained\" color=\"primary\" type=\"submit\">\n                    Next step\n                  </Button>\n                </Form>\n              </StepContent>\n            </StepUI>\n          );\n        })}\n      </Stepper>\n      {activeStep === steps.length && (\n        <Content>\n          <Paper square elevation={0}>\n            <Typography variant=\"h6\">Review and create</Typography>\n            <StructuredMetadataTable\n              dense\n              metadata={getReviewData(formData, steps)}\n            />\n            <Box mb={4} />\n            <Button onClick={handleBack} disabled={disableButtons}>\n              Back\n            </Button>\n            <Button onClick={handleReset} disabled={disableButtons}>\n              Reset\n            </Button>\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              onClick={handleCreate}\n              disabled={!onFinish || disableButtons}\n            >\n              {finishButtonLabel ?? 'Create'}\n            </Button>\n          </Paper>\n        </Content>\n      )}\n    </>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CustomFieldValidator } from '../../extensions';\nimport { FormValidation } from '@rjsf/core';\nimport { JsonObject, JsonValue } from '@backstage/types';\nimport { ApiHolder } from '@backstage/core-plugin-api';\n\nfunction isObject(obj: unknown): obj is JsonObject {\n  return typeof obj === 'object' && obj !== null && !Array.isArray(obj);\n}\n\nexport const createValidator = (\n  rootSchema: JsonObject,\n  validators: Record<string, undefined | CustomFieldValidator<unknown>>,\n  context: {\n    apiHolder: ApiHolder;\n  },\n) => {\n  function validate(\n    schema: JsonObject,\n    formData: JsonObject,\n    errors: FormValidation,\n  ) {\n    const schemaProps = schema.properties;\n    const customObject = schema.type === 'object' && schemaProps === undefined;\n\n    if (!isObject(schemaProps) && !customObject) {\n      return;\n    }\n\n    if (schemaProps) {\n      for (const [key, propData] of Object.entries(formData)) {\n        const propValidation = errors[key];\n\n        if (isObject(propData)) {\n          const propSchemaProps = schemaProps[key];\n          if (isObject(propSchemaProps)) {\n            validate(\n              propSchemaProps,\n              propData as JsonObject,\n              propValidation as FormValidation,\n            );\n          }\n        } else {\n          const propSchema = schemaProps[key];\n          const fieldName =\n            isObject(propSchema) && (propSchema['ui:field'] as string);\n          if (fieldName && typeof validators[fieldName] === 'function') {\n            validators[fieldName]!(\n              propData as JsonValue,\n              propValidation,\n              context,\n            );\n          }\n        }\n      }\n    } else if (customObject) {\n      const fieldName = schema['ui:field'] as string;\n      if (fieldName && typeof validators[fieldName] === 'function') {\n        validators[fieldName]!(formData, errors, context);\n      }\n    }\n  }\n\n  return (formData: JsonObject, errors: FormValidation) => {\n    validate(rootSchema, formData, errors);\n    return errors;\n  };\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { LinearProgress } from '@material-ui/core';\nimport { IChangeEvent } from '@rjsf/core';\nimport qs from 'qs';\nimport React, { useCallback, useContext, useState } from 'react';\nimport { Navigate, useNavigate } from 'react-router';\nimport useAsync from 'react-use/lib/useAsync';\nimport { scaffolderApiRef } from '../../api';\nimport { FieldExtensionOptions } from '../../extensions';\nimport { SecretsContext } from '../secrets/SecretsContext';\nimport {\n  rootRouteRef,\n  scaffolderTaskRouteRef,\n  selectedTemplateRouteRef,\n} from '../../routes';\nimport { MultistepJsonForm } from '../MultistepJsonForm';\nimport { createValidator } from './createValidator';\n\nimport { Content, Header, InfoCard, Page } from '@backstage/core-components';\nimport {\n  AnalyticsContext,\n  errorApiRef,\n  useApi,\n  useApiHolder,\n  useRouteRef,\n  useRouteRefParams,\n} from '@backstage/core-plugin-api';\nimport { stringifyEntityRef } from '@backstage/catalog-model';\nimport { LayoutOptions } from '../../layouts';\n\nconst useTemplateParameterSchema = (templateRef: string) => {\n  const scaffolderApi = useApi(scaffolderApiRef);\n  const { value, loading, error } = useAsync(\n    () => scaffolderApi.getTemplateParameterSchema(templateRef),\n    [scaffolderApi, templateRef],\n  );\n  return { schema: value, loading, error };\n};\n\nexport const TemplatePage = ({\n  customFieldExtensions = [],\n  layouts = [],\n}: {\n  customFieldExtensions?: FieldExtensionOptions<any, any>[];\n  layouts?: LayoutOptions[];\n}) => {\n  const apiHolder = useApiHolder();\n  const secretsContext = useContext(SecretsContext);\n  const errorApi = useApi(errorApiRef);\n  const scaffolderApi = useApi(scaffolderApiRef);\n  const { templateName, namespace } = useRouteRefParams(\n    selectedTemplateRouteRef,\n  );\n  const templateRef = stringifyEntityRef({\n    name: templateName,\n    kind: 'template',\n    namespace,\n  });\n  const navigate = useNavigate();\n  const scaffolderTaskRoute = useRouteRef(scaffolderTaskRouteRef);\n  const rootRoute = useRouteRef(rootRouteRef);\n  const { schema, loading, error } = useTemplateParameterSchema(templateRef);\n  const [formState, setFormState] = useState<Record<string, any>>(() => {\n    const query = qs.parse(window.location.search, {\n      ignoreQueryPrefix: true,\n    });\n\n    try {\n      return JSON.parse(query.formData as string);\n    } catch (e) {\n      return query.formData ?? {};\n    }\n  });\n  const handleFormReset = () => setFormState({});\n  const handleChange = useCallback(\n    (e: IChangeEvent) => setFormState(e.formData),\n    [setFormState],\n  );\n\n  const handleCreate = async () => {\n    const { taskId } = await scaffolderApi.scaffold({\n      templateRef,\n      values: formState,\n      secrets: secretsContext?.secrets,\n    });\n\n    const formParams = qs.stringify(\n      { formData: formState },\n      { addQueryPrefix: true },\n    );\n    const newUrl = `${window.location.pathname}${formParams}`;\n    // We use direct history manipulation since useSearchParams and\n    // useNavigate in react-router-dom cause unnecessary extra rerenders.\n    // Also make sure to replace the state rather than pushing to avoid\n    // extra back/forward slots.\n    window.history?.replaceState(null, document.title, newUrl);\n\n    navigate(scaffolderTaskRoute({ taskId }));\n  };\n\n  if (error) {\n    errorApi.post(new Error(`Failed to load template, ${error}`));\n    return <Navigate to={rootRoute()} />;\n  }\n  if (!loading && !schema) {\n    errorApi.post(new Error('Template was not found.'));\n    return <Navigate to={rootRoute()} />;\n  }\n\n  const customFieldComponents = Object.fromEntries(\n    customFieldExtensions.map(({ name, component }) => [name, component]),\n  );\n\n  const customFieldValidators = Object.fromEntries(\n    customFieldExtensions.map(({ name, validation }) => [name, validation]),\n  );\n\n  return (\n    <AnalyticsContext attributes={{ entityRef: templateRef }}>\n      <Page themeId=\"home\">\n        <Header\n          pageTitleOverride=\"Create a New Component\"\n          title=\"Create a New Component\"\n          subtitle=\"Create new software components using standard templates\"\n        />\n        <Content>\n          {loading && <LinearProgress data-testid=\"loading-progress\" />}\n          {schema && (\n            <InfoCard\n              title={schema.title}\n              noPadding\n              titleTypographyProps={{ component: 'h2' }}\n            >\n              <MultistepJsonForm\n                formData={formState}\n                fields={customFieldComponents}\n                onChange={handleChange}\n                onReset={handleFormReset}\n                onFinish={handleCreate}\n                layouts={layouts}\n                steps={schema.steps.map(step => {\n                  return {\n                    ...step,\n                    validate: createValidator(\n                      step.schema,\n                      customFieldValidators,\n                      { apiHolder },\n                    ),\n                  };\n                })}\n              />\n            </InfoCard>\n          )}\n        </Content>\n      </Page>\n    </AnalyticsContext>\n  );\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport useAsync from 'react-use/lib/useAsync';\nimport { scaffolderApiRef } from '../../api';\nimport {\n  Typography,\n  Paper,\n  Table,\n  TableBody,\n  Box,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  makeStyles,\n} from '@material-ui/core';\nimport { JSONSchema7, JSONSchema7Definition } from 'json-schema';\nimport classNames from 'classnames';\n\nimport { useApi } from '@backstage/core-plugin-api';\nimport {\n  Progress,\n  Content,\n  Header,\n  Page,\n  ErrorPage,\n} from '@backstage/core-components';\n\nconst useStyles = makeStyles(theme => ({\n  code: {\n    fontFamily: 'Menlo, monospace',\n    padding: theme.spacing(1),\n    backgroundColor:\n      theme.palette.type === 'dark'\n        ? theme.palette.grey[700]\n        : theme.palette.grey[300],\n    display: 'inline-block',\n    borderRadius: 5,\n    border: `1px solid ${theme.palette.grey[500]}`,\n    position: 'relative',\n  },\n\n  codeRequired: {\n    '&::after': {\n      position: 'absolute',\n      content: '\"*\"',\n      top: 0,\n      right: theme.spacing(0.5),\n      fontWeight: 'bolder',\n      color: theme.palette.error.light,\n    },\n  },\n}));\n\nexport const ActionsPage = () => {\n  const api = useApi(scaffolderApiRef);\n  const classes = useStyles();\n  const { loading, value, error } = useAsync(async () => {\n    return api.listActions();\n  });\n\n  if (loading) {\n    return <Progress />;\n  }\n\n  if (error) {\n    return (\n      <ErrorPage\n        statusMessage=\"Failed to load installed actions\"\n        status=\"500\"\n      />\n    );\n  }\n\n  const formatRows = (input: JSONSchema7) => {\n    const properties = input.properties;\n    if (!properties) {\n      return undefined;\n    }\n\n    return Object.entries(properties).map(entry => {\n      const [key] = entry;\n      const props = entry[1] as unknown as JSONSchema7;\n      const codeClassname = classNames(classes.code, {\n        [classes.codeRequired]: input.required?.includes(key),\n      });\n\n      return (\n        <TableRow key={key}>\n          <TableCell>\n            <div className={codeClassname}>{key}</div>\n          </TableCell>\n          <TableCell>{props.title}</TableCell>\n          <TableCell>{props.description}</TableCell>\n          <TableCell>\n            <span className={classes.code}>{props.type}</span>\n          </TableCell>\n        </TableRow>\n      );\n    });\n  };\n\n  const renderTable = (input: JSONSchema7) => {\n    if (!input.properties) {\n      return undefined;\n    }\n    return (\n      <TableContainer component={Paper}>\n        <Table size=\"small\">\n          <TableHead>\n            <TableRow>\n              <TableCell>Name</TableCell>\n              <TableCell>Title</TableCell>\n              <TableCell>Description</TableCell>\n              <TableCell>Type</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>{formatRows(input)}</TableBody>\n        </Table>\n      </TableContainer>\n    );\n  };\n\n  const renderTables = (name: string, input?: JSONSchema7Definition[]) => {\n    if (!input) {\n      return undefined;\n    }\n\n    return (\n      <>\n        <Typography variant=\"h6\">{name}</Typography>\n        {input.map((i, index) => (\n          <div key={index}>{renderTable(i as unknown as JSONSchema7)}</div>\n        ))}\n      </>\n    );\n  };\n\n  const items = value?.map(action => {\n    if (action.id.startsWith('legacy:')) {\n      return undefined;\n    }\n\n    const oneOf = renderTables('oneOf', action.schema?.input?.oneOf);\n    return (\n      <Box pb={4} key={action.id}>\n        <Typography variant=\"h4\" className={classes.code}>\n          {action.id}\n        </Typography>\n        <Typography>{action.description}</Typography>\n        {action.schema?.input && (\n          <Box pb={2}>\n            <Typography variant=\"h5\">Input</Typography>\n            {renderTable(action.schema.input)}\n            {oneOf}\n          </Box>\n        )}\n        {action.schema?.output && (\n          <Box pb={2}>\n            <Typography variant=\"h5\">Output</Typography>\n            {renderTable(action.schema.output)}\n          </Box>\n        )}\n      </Box>\n    );\n  });\n\n  return (\n    <Page themeId=\"home\">\n      <Header\n        pageTitleOverride=\"Create a New Component\"\n        title=\"Installed actions\"\n        subtitle=\"This is the collection of all installed actions\"\n      />\n      <Content>{items}</Content>\n    </Page>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TemplateDirectoryAccess, TemplateFileAccess } from './types';\n\ntype WritableFileHandle = FileSystemFileHandle & {\n  createWritable(): Promise<{\n    write(data: string | Blob | BufferSource): Promise<void>;\n    close(): Promise<void>;\n  }>;\n};\n\n// A nicer type than the one from the TS lib\ninterface IterableDirectoryHandle extends FileSystemDirectoryHandle {\n  values(): AsyncIterable<\n    | ({ kind: 'file' } & WritableFileHandle)\n    | ({ kind: 'directory' } & IterableDirectoryHandle)\n  >;\n}\n\nconst showDirectoryPicker = (window as any).showDirectoryPicker as\n  | (() => Promise<IterableDirectoryHandle>)\n  | undefined;\n\nclass WebFileAccess implements TemplateFileAccess {\n  constructor(\n    readonly path: string,\n    private readonly handle: WritableFileHandle,\n  ) {}\n\n  file(): Promise<File> {\n    return this.handle.getFile();\n  }\n\n  async save(data: string | Blob | BufferSource): Promise<void> {\n    const writable = await this.handle.createWritable();\n    await writable.write(data);\n    await writable.close();\n  }\n}\n\nclass WebDirectoryAccess implements TemplateDirectoryAccess {\n  constructor(private readonly handle: IterableDirectoryHandle) {}\n\n  async listFiles(): Promise<TemplateFileAccess[]> {\n    const content = [];\n    for await (const entry of this.listDirectoryContents(this.handle)) {\n      content.push(entry);\n    }\n    return content;\n  }\n\n  private async *listDirectoryContents(\n    dirHandle: IterableDirectoryHandle,\n    basePath: string[] = [],\n  ): AsyncIterable<TemplateFileAccess> {\n    for await (const handle of dirHandle.values()) {\n      if (handle.kind === 'file') {\n        yield new WebFileAccess([...basePath, handle.name].join('/'), handle);\n      } else if (handle.kind === 'directory') {\n        // Skip git storage directory\n        if (handle.name === '.git') {\n          continue;\n        }\n        yield* this.listDirectoryContents(handle, [...basePath, handle.name]);\n      }\n    }\n  }\n}\n\n/** @internal */\nexport class WebFileSystemAccess {\n  static isSupported(): boolean {\n    return Boolean(showDirectoryPicker);\n  }\n\n  static async requestDirectoryAccess(): Promise<TemplateDirectoryAccess> {\n    if (!showDirectoryPicker) {\n      throw new Error('File system access is not supported');\n    }\n    const handle = await showDirectoryPicker();\n    return new WebDirectoryAccess(handle);\n  }\n\n  private constructor() {}\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport CardContent from '@material-ui/core/CardContent';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { WebFileSystemAccess } from '../../lib/filesystem';\n\nconst useStyles = makeStyles(theme => ({\n  introText: {\n    textAlign: 'center',\n    marginTop: theme.spacing(2),\n  },\n  card: {\n    position: 'relative',\n    maxWidth: 340,\n    marginTop: theme.spacing(4),\n    margin: theme.spacing(0, 2),\n  },\n  infoIcon: {\n    position: 'absolute',\n    top: theme.spacing(1),\n    right: theme.spacing(1),\n  },\n}));\n\ninterface EditorIntroProps {\n  style?: JSX.IntrinsicElements['div']['style'];\n  onSelect?: (option: 'local' | 'form') => void;\n}\n\nexport function TemplateEditorIntro(props: EditorIntroProps) {\n  const classes = useStyles();\n  const supportsLoad = WebFileSystemAccess.isSupported();\n\n  const cardLoadLocal = (\n    <Card className={classes.card} elevation={4}>\n      <CardActionArea\n        disabled={!supportsLoad}\n        onClick={() => props.onSelect?.('local')}\n      >\n        <CardContent>\n          <Typography\n            variant=\"h5\"\n            gutterBottom\n            color={supportsLoad ? undefined : 'textSecondary'}\n            style={{ display: 'flex', flexFlow: 'row nowrap' }}\n          >\n            Load Template Directory\n          </Typography>\n          <Typography\n            variant=\"body1\"\n            color={supportsLoad ? undefined : 'textSecondary'}\n          >\n            Load a local template directory, allowing you to both edit and try\n            executing your own template.\n          </Typography>\n        </CardContent>\n      </CardActionArea>\n      {!supportsLoad && (\n        <div className={classes.infoIcon}>\n          <Tooltip\n            placement=\"top\"\n            title=\"Only supported in some Chromium-based browsers\"\n          >\n            <InfoOutlinedIcon />\n          </Tooltip>\n        </div>\n      )}\n    </Card>\n  );\n\n  const cardFormEditor = (\n    <Card className={classes.card} elevation={4}>\n      <CardActionArea onClick={() => props.onSelect?.('form')}>\n        <CardContent>\n          <Typography variant=\"h5\" gutterBottom>\n            Edit Template Form\n          </Typography>\n          <Typography variant=\"body1\">\n            Preview and edit a template form, either using a sample template or\n            by loading a template from the catalog.\n          </Typography>\n        </CardContent>\n      </CardActionArea>\n    </Card>\n  );\n\n  return (\n    <div style={props.style}>\n      <Typography variant=\"h6\" className={classes.introText}>\n        Get started by choosing one of the options below\n      </Typography>\n      <div\n        style={{\n          display: 'flex',\n          flexFlow: 'row wrap',\n          alignItems: 'flex-start',\n          justifyContent: 'center',\n          alignContent: 'flex-start',\n        }}\n      >\n        {supportsLoad && cardLoadLocal}\n        {cardFormEditor}\n        {!supportsLoad && cardLoadLocal}\n      </div>\n    </div>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ErrorPanel, Progress } from '@backstage/core-components';\nimport { useAsync, useRerender } from '@react-hookz/web';\nimport React, { createContext, ReactNode, useContext, useEffect } from 'react';\nimport {\n  TemplateDirectoryAccess,\n  TemplateFileAccess,\n} from '../../lib/filesystem';\n\nconst MAX_SIZE = 1024 * 1024;\nconst MAX_SIZE_MESSAGE = 'This file is too large to be displayed';\n\ninterface DirectoryEditorFile {\n  /** The path of the file relative to the root directory */\n  path: string;\n  /** The staged content of the file */\n  content: string;\n  /** Whether the staged content matches what is on disk */\n  dirty: boolean;\n\n  /** Update the staged content of the file without saving */\n  updateContent(content: string): void;\n  /** Save the staged content of the file to disk */\n  save(): Promise<void>;\n  /** Reload the staged content of the file from disk */\n  reload(): Promise<void>;\n}\n\ninterface DirectoryEditor {\n  /** A list of all files in the edited directory */\n  files: Array<DirectoryEditorFile>;\n\n  /** The currently selected file */\n  selectedFile: DirectoryEditorFile | undefined;\n  /** Switch the selected file */\n  setSelectedFile(path: string | undefined): void;\n\n  /** Save all files to disk */\n  save(): Promise<void>;\n  /** Reload all files from disk */\n  reload(): Promise<void>;\n\n  subscribe(listener: () => void): () => void;\n}\n\nclass DirectoryEditorFileManager implements DirectoryEditorFile {\n  readonly #access: TemplateFileAccess;\n  readonly #signalUpdate: () => void;\n\n  #content?: string;\n  #savedContent?: string;\n\n  constructor(access: TemplateFileAccess, signalUpdate: () => void) {\n    this.#access = access;\n    this.#signalUpdate = signalUpdate;\n  }\n\n  get path() {\n    return this.#access.path;\n  }\n\n  get content() {\n    return this.#content ?? MAX_SIZE_MESSAGE;\n  }\n\n  updateContent(content: string): void {\n    if (this.#content === undefined) {\n      return;\n    }\n    this.#content = content;\n    this.#signalUpdate();\n  }\n\n  get dirty() {\n    return this.#content !== this.#savedContent;\n  }\n\n  async save(): Promise<void> {\n    if (this.#content !== undefined) {\n      await this.#access.save(this.#content);\n      this.#savedContent = this.#content;\n      this.#signalUpdate();\n    }\n  }\n\n  async reload(): Promise<void> {\n    const file = await this.#access.file();\n    if (file.size > MAX_SIZE) {\n      if (this.#content !== undefined) {\n        this.#content = undefined;\n        this.#savedContent = undefined;\n        this.#signalUpdate();\n      }\n      return;\n    }\n\n    const content = await file.text();\n    if (this.#content !== content) {\n      this.#content = content;\n      this.#savedContent = content;\n      this.#signalUpdate();\n    }\n  }\n}\n\nclass DirectoryEditorManager implements DirectoryEditor {\n  readonly #access: TemplateDirectoryAccess;\n  readonly #listeners = new Set<() => void>();\n\n  #files: DirectoryEditorFile[] = [];\n  #selectedFile: DirectoryEditorFile | undefined;\n\n  constructor(access: TemplateDirectoryAccess) {\n    this.#access = access;\n  }\n\n  get files() {\n    return this.#files;\n  }\n\n  get selectedFile() {\n    return this.#selectedFile;\n  }\n\n  setSelectedFile = (path: string | undefined): void => {\n    const prev = this.#selectedFile;\n    const next = this.#files.find(file => file.path === path);\n    if (prev !== next) {\n      this.#selectedFile = next;\n      this.#signalUpdate();\n    }\n  };\n\n  get dirty() {\n    return this.#files.some(file => file.dirty);\n  }\n\n  async save(): Promise<void> {\n    await Promise.all(this.#files.map(file => file.save()));\n  }\n\n  async reload(): Promise<void> {\n    const selectedPath = this.#selectedFile?.path;\n\n    const files = await this.#access.listFiles();\n    const fileManagers = await Promise.all(\n      files.map(async file => {\n        const manager = new DirectoryEditorFileManager(\n          file,\n          this.#signalUpdate,\n        );\n        await manager.reload();\n        return manager;\n      }),\n    );\n    this.#files.length = 0;\n    this.#files.push(...fileManagers);\n\n    this.setSelectedFile(selectedPath);\n    this.#signalUpdate();\n  }\n\n  subscribe(listener: () => void): () => void {\n    this.#listeners.add(listener);\n    return () => {\n      this.#listeners.delete(listener);\n    };\n  }\n\n  #signalUpdate = () => {\n    this.#listeners.forEach(listener => listener());\n  };\n}\n\nconst DirectoryEditorContext = createContext<DirectoryEditor | undefined>(\n  undefined,\n);\n\nexport function useDirectoryEditor(): DirectoryEditor {\n  const value = useContext(DirectoryEditorContext);\n  const rerender = useRerender();\n\n  useEffect(() => value?.subscribe(rerender), [value, rerender]);\n\n  if (!value) {\n    throw new Error('must be used within a DirectoryEditorProvider');\n  }\n  return value;\n}\n\ninterface DirectoryEditorProviderProps {\n  directory: TemplateDirectoryAccess;\n  children?: ReactNode;\n}\n\nexport function DirectoryEditorProvider(props: DirectoryEditorProviderProps) {\n  const { directory } = props;\n\n  const [{ result, error }, { execute }] = useAsync(\n    async (dir: TemplateDirectoryAccess) => {\n      const manager = new DirectoryEditorManager(dir);\n      await manager.reload();\n\n      const firstYaml = manager.files.find(file => file.path.match(/\\.ya?ml$/));\n      if (firstYaml) {\n        manager.setSelectedFile(firstYaml.path);\n      }\n\n      return manager;\n    },\n  );\n\n  useEffect(() => {\n    execute(directory);\n  }, [execute, directory]);\n\n  if (error) {\n    return <ErrorPanel error={error} />;\n  } else if (!result) {\n    return <Progress />;\n  }\n\n  return (\n    <DirectoryEditorContext.Provider value={result}>\n      {props.children}\n    </DirectoryEditorContext.Provider>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport yaml from 'yaml';\nimport { useApi } from '@backstage/core-plugin-api';\nimport { JsonObject } from '@backstage/types';\nimport React, {\n  createContext,\n  ReactNode,\n  useCallback,\n  useContext,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { scaffolderApiRef } from '../../api';\nimport { ScaffolderDryRunResponse } from '../../types';\n\nconst MAX_CONTENT_SIZE = 64 * 1024;\nconst CHUNK_SIZE = 32 * 1024;\n\ninterface DryRunOptions {\n  templateContent: string;\n  values: JsonObject;\n  files: Array<{ path: string; content: string }>;\n}\n\ninterface DryRunResult extends ScaffolderDryRunResponse {\n  id: number;\n}\n\ninterface DryRun {\n  results: DryRunResult[];\n  selectedResult: DryRunResult | undefined;\n\n  selectResult(id: number): void;\n  deleteResult(id: number): void;\n  execute(options: DryRunOptions): Promise<void>;\n}\n\nconst DryRunContext = createContext<DryRun | undefined>(undefined);\n\ninterface DryRunProviderProps {\n  children: ReactNode;\n}\n\nexport function base64EncodeContent(content: string): string {\n  if (content.length > MAX_CONTENT_SIZE) {\n    return btoa('<file too large>');\n  }\n\n  try {\n    return btoa(content);\n  } catch {\n    const decoder = new TextEncoder();\n    const buffer = decoder.encode(content);\n\n    const chunks = new Array<string>();\n    for (let offset = 0; offset < buffer.length; offset += CHUNK_SIZE) {\n      chunks.push(\n        String.fromCharCode(...buffer.slice(offset, offset + CHUNK_SIZE)),\n      );\n    }\n    return btoa(chunks.join(''));\n  }\n}\n\nexport function DryRunProvider(props: DryRunProviderProps) {\n  const scaffolderApi = useApi(scaffolderApiRef);\n\n  const [state, setState] = useState<\n    Pick<DryRun, 'results' | 'selectedResult'>\n  >({\n    results: [],\n    selectedResult: undefined,\n  });\n  const idRef = useRef(1);\n\n  const selectResult = useCallback((id: number) => {\n    setState(prevState => {\n      const result = prevState.results.find(r => r.id === id);\n      if (result === prevState.selectedResult) {\n        return prevState;\n      }\n      return {\n        results: prevState.results,\n        selectedResult: result,\n      };\n    });\n  }, []);\n\n  const deleteResult = useCallback((id: number) => {\n    setState(prevState => {\n      const index = prevState.results.findIndex(r => r.id === id);\n      if (index === -1) {\n        return prevState;\n      }\n      const newResults = prevState.results.slice();\n      const [deleted] = newResults.splice(index, 1);\n      return {\n        results: newResults,\n        selectedResult:\n          prevState.selectedResult?.id === deleted.id\n            ? newResults[0]\n            : prevState.selectedResult,\n      };\n    });\n  }, []);\n\n  const execute = useCallback(\n    async (options: DryRunOptions) => {\n      if (!scaffolderApi.dryRun) {\n        throw new Error('Scaffolder API does not support dry-run');\n      }\n\n      const parsed = yaml.parse(options.templateContent);\n\n      const response = await scaffolderApi.dryRun({\n        template: parsed,\n        values: options.values,\n        secrets: {},\n        directoryContents: options.files.map(file => ({\n          path: file.path,\n          base64Content: base64EncodeContent(file.content),\n        })),\n      });\n\n      const result = {\n        ...response,\n        id: idRef.current++,\n      };\n\n      setState(prevState => ({\n        results: [...prevState.results, result],\n        selectedResult: prevState.selectedResult ?? result,\n      }));\n    },\n    [scaffolderApi],\n  );\n\n  const dryRun = useMemo(\n    () => ({\n      ...state,\n      selectResult,\n      deleteResult,\n      execute,\n    }),\n    [state, selectResult, deleteResult, execute],\n  );\n\n  return (\n    <DryRunContext.Provider value={dryRun}>\n      {props.children}\n    </DryRunContext.Provider>\n  );\n}\n\nexport function useDryRun(): DryRun {\n  const value = useContext(DryRunContext);\n  if (!value) {\n    throw new Error('must be used within a DryRunProvider');\n  }\n  return value;\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstageTheme } from '@backstage/theme';\nimport IconButton from '@material-ui/core/IconButton';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport CheckIcon from '@material-ui/icons/Check';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport React from 'react';\nimport { useDryRun } from '../DryRunContext';\n\nconst useStyles = makeStyles((theme: BackstageTheme) => ({\n  root: {\n    overflowY: 'auto',\n    background: theme.palette.background.default,\n  },\n  iconSuccess: {\n    minWidth: 0,\n    marginRight: theme.spacing(1),\n    color: theme.palette.status.ok,\n  },\n  iconFailure: {\n    minWidth: 0,\n    marginRight: theme.spacing(1),\n    color: theme.palette.status.error,\n  },\n}));\n\nexport function DryRunResultsList() {\n  const classes = useStyles();\n  const dryRun = useDryRun();\n\n  return (\n    <List className={classes.root} dense>\n      {dryRun.results.map(result => {\n        const failed = result.log.some(l => l.body.status === 'failed');\n        return (\n          <ListItem\n            button\n            key={result.id}\n            selected={dryRun.selectedResult?.id === result.id}\n            onClick={() => dryRun.selectResult(result.id)}\n          >\n            <ListItemIcon\n              className={failed ? classes.iconFailure : classes.iconSuccess}\n            >\n              {failed ? <CancelIcon /> : <CheckIcon />}\n            </ListItemIcon>\n            <ListItemText primary={`Result ${result.id}`} />\n            <ListItemSecondaryAction>\n              <IconButton\n                edge=\"end\"\n                aria-label=\"delete\"\n                onClick={() => dryRun.deleteResult(result.id)}\n              >\n                <DeleteIcon />\n              </IconButton>\n            </ListItemSecondaryAction>\n          </ListItem>\n        );\n      })}\n    </List>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TreeView from '@material-ui/lab/TreeView';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport TreeItem from '@material-ui/lab/TreeItem';\n\nconst useStyles = makeStyles({\n  root: {\n    whiteSpace: 'nowrap',\n    overflowY: 'auto',\n  },\n});\n\nexport type FileEntry =\n  | {\n      type: 'file';\n      name: string;\n      path: string;\n    }\n  | {\n      type: 'directory';\n      name: string;\n      path: string;\n      children: FileEntry[];\n    };\n\nexport function parseFileEntires(paths: string[]): FileEntry[] {\n  const root: FileEntry = {\n    type: 'directory',\n    name: '',\n    path: '',\n    children: [],\n  };\n\n  for (const path of paths.slice().sort()) {\n    const parts = path.split('/');\n\n    let current = root;\n    for (let i = 0; i < parts.length; i++) {\n      const part = parts[i];\n      if (part === '') {\n        throw new Error(`Invalid path part: ''`);\n      }\n\n      const entryPath = parts.slice(0, i + 1).join('/');\n\n      const existing = current.children.find(child => child.name === part);\n      if (existing?.type === 'file') {\n        throw new Error(`Duplicate filename at '${entryPath}'`);\n      } else if (existing) {\n        current = existing;\n      } else {\n        if (i < parts.length - 1) {\n          const newEntry: FileEntry = {\n            type: 'directory',\n            name: part,\n            path: entryPath,\n            children: [],\n          };\n          const firstFileIndex = current.children.findIndex(\n            child => child.type === 'file',\n          );\n          current.children.splice(firstFileIndex, 0, newEntry);\n          current = newEntry;\n        } else {\n          current.children.push({\n            type: 'file',\n            name: part,\n            path: entryPath,\n          });\n        }\n      }\n    }\n  }\n\n  return root.children;\n}\n\nfunction FileTreeItem({ entry }: { entry: FileEntry }) {\n  if (entry.type === 'file') {\n    return <TreeItem nodeId={entry.path} label={entry.name} />;\n  }\n\n  return (\n    <TreeItem nodeId={entry.path} label={entry.name}>\n      {entry.children.map(child => (\n        <FileTreeItem key={child.path} entry={child} />\n      ))}\n    </TreeItem>\n  );\n}\n\ninterface FileBrowserProps {\n  /** A list of all filepaths to show, directories are separated with a `/` */\n  filePaths: string[];\n  /** The currently selected file */\n  selected?: string;\n  /** Callback for when a file is selected */\n  onSelect?(filePath: string): void;\n}\n\n/** A simple file browser that allows you to select individual files */\nexport function FileBrowser(props: FileBrowserProps) {\n  const classes = useStyles();\n\n  const fileTree = useMemo(\n    () => parseFileEntires(props.filePaths),\n    [props.filePaths],\n  );\n\n  return (\n    <TreeView\n      selected={props.selected}\n      className={classes.root}\n      defaultCollapseIcon={<ExpandMoreIcon />}\n      defaultExpandIcon={<ChevronRightIcon />}\n      onNodeSelect={(_e: unknown, nodeId: string) => {\n        if (props.onSelect && props.filePaths.includes(nodeId)) {\n          props.onSelect(nodeId);\n        }\n      }}\n    >\n      {fileTree.map(entry => (\n        <FileTreeItem key={entry.path} entry={entry} />\n      ))}\n    </TreeView>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Divider from '@material-ui/core/Divider';\nimport React, { Children, ReactNode } from 'react';\nimport classNames from 'classnames';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'grid',\n    gridTemplateColumns: '280px auto 3fr',\n    gridTemplateRows: '1fr',\n  },\n  child: {\n    overflowY: 'auto',\n    height: '100%',\n    minHeight: 0,\n  },\n  firstChild: {\n    background: theme.palette.background.paper,\n  },\n}));\n\nexport function DryRunResultsSplitView(props: { children: ReactNode }) {\n  const classes = useStyles();\n  const childArray = Children.toArray(props.children);\n\n  if (childArray.length !== 2) {\n    throw new Error('must have exactly 2 children');\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classNames(classes.child, classes.firstChild)}>\n        {childArray[0]}\n      </div>\n      <Divider orientation=\"horizontal\" />\n      <div className={classes.child}>{childArray[1]}</div>\n    </div>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LogViewer } from '@backstage/core-components';\nimport { StreamLanguage } from '@codemirror/language';\nimport { yaml as yamlSupport } from '@codemirror/legacy-modes/mode/yaml';\nimport Box from '@material-ui/core/Box';\nimport Divider from '@material-ui/core/Divider';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Tab from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\nimport CodeMirror from '@uiw/react-codemirror';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { TaskStatusStepper } from '../../TaskPage/TaskPage';\nimport { TaskPageLinks } from '../../TaskPage/TaskPageLinks';\nimport { useDryRun } from '../DryRunContext';\nimport { FileBrowser } from '../../FileBrowser';\nimport { DryRunResultsSplitView } from './DryRunResultsSplitView';\n\nconst useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexFlow: 'column nowrap',\n  },\n  contentWrapper: {\n    flex: 1,\n    position: 'relative',\n  },\n  content: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n\n    display: 'flex',\n    '& > *': {\n      flex: 1,\n    },\n  },\n  codeMirror: {\n    height: '100%',\n    overflowY: 'auto',\n  },\n});\n\nfunction FilesContent() {\n  const classes = useStyles();\n  const { selectedResult } = useDryRun();\n  const [selectedPath, setSelectedPath] = useState<string>('');\n  const selectedFile = selectedResult?.directoryContents.find(\n    f => f.path === selectedPath,\n  );\n\n  useEffect(() => {\n    if (selectedResult) {\n      const [firstFile] = selectedResult.directoryContents;\n      if (firstFile) {\n        setSelectedPath(firstFile.path);\n      } else {\n        setSelectedPath('');\n      }\n    }\n    return undefined;\n  }, [selectedResult]);\n\n  if (!selectedResult) {\n    return null;\n  }\n  return (\n    <DryRunResultsSplitView>\n      <FileBrowser\n        selected={selectedPath}\n        onSelect={setSelectedPath}\n        filePaths={selectedResult.directoryContents.map(file => file.path)}\n      />\n      <CodeMirror\n        className={classes.codeMirror}\n        theme=\"dark\"\n        height=\"100%\"\n        extensions={[StreamLanguage.define(yamlSupport)]}\n        readOnly\n        value={\n          selectedFile?.base64Content ? atob(selectedFile.base64Content) : ''\n        }\n      />\n    </DryRunResultsSplitView>\n  );\n}\nfunction LogContent() {\n  const { selectedResult } = useDryRun();\n  const [currentStepId, setUserSelectedStepId] = useState<string>();\n\n  const steps = useMemo(() => {\n    if (!selectedResult) {\n      return [];\n    }\n    return (\n      selectedResult.steps.map(step => {\n        const stepLog = selectedResult.log.filter(\n          l => l.body.stepId === step.id,\n        );\n        return {\n          id: step.id,\n          name: step.name,\n          logString: stepLog.map(l => l.body.message).join('\\n'),\n          status: stepLog[stepLog.length - 1]?.body.status ?? 'completed',\n        };\n      }) ?? []\n    );\n  }, [selectedResult]);\n\n  if (!selectedResult) {\n    return null;\n  }\n\n  const selectedStep = steps.find(s => s.id === currentStepId) ?? steps[0];\n\n  return (\n    <DryRunResultsSplitView>\n      <TaskStatusStepper\n        steps={steps}\n        currentStepId={selectedStep.id}\n        onUserStepChange={setUserSelectedStepId}\n      />\n      <LogViewer text={selectedStep?.logString ?? ''} />\n    </DryRunResultsSplitView>\n  );\n}\n\nfunction OutputContent() {\n  const classes = useStyles();\n  const { selectedResult } = useDryRun();\n\n  if (!selectedResult) {\n    return null;\n  }\n\n  return (\n    <DryRunResultsSplitView>\n      <Box pt={2}>\n        {selectedResult.output?.links?.length && (\n          <TaskPageLinks output={selectedResult.output} />\n        )}\n      </Box>\n      <CodeMirror\n        className={classes.codeMirror}\n        theme=\"dark\"\n        height=\"100%\"\n        extensions={[StreamLanguage.define(yamlSupport)]}\n        readOnly\n        value={JSON.stringify(selectedResult.output, null, 2)}\n      />\n    </DryRunResultsSplitView>\n  );\n}\n\nexport function DryRunResultsView() {\n  const classes = useStyles();\n  const [selectedTab, setSelectedTab] = useState<'files' | 'log' | 'output'>(\n    'files',\n  );\n\n  return (\n    <div className={classes.root}>\n      <Tabs value={selectedTab} onChange={(_, v) => setSelectedTab(v)}>\n        <Tab value=\"files\" label=\"Files\" />\n        <Tab value=\"log\" label=\"Log\" />\n        <Tab value=\"output\" label=\"Output\" />\n      </Tabs>\n      <Divider />\n\n      <div className={classes.contentWrapper}>\n        <div className={classes.content}>\n          {selectedTab === 'files' && <FilesContent />}\n          {selectedTab === 'log' && <LogContent />}\n          {selectedTab === 'output' && <OutputContent />}\n        </div>\n      </div>\n    </div>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BackstageTheme } from '@backstage/theme';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport Divider from '@material-ui/core/Divider';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandLess';\nimport { usePrevious } from '@react-hookz/web';\nimport React, { useEffect, useState } from 'react';\nimport { useDryRun } from '../DryRunContext';\nimport { DryRunResultsList } from './DryRunResultsList';\nimport { DryRunResultsView } from './DryRunResultsView';\n\nconst useStyles = makeStyles((theme: BackstageTheme) => ({\n  header: {\n    height: 48,\n    minHeight: 0,\n    '&.Mui-expanded': {\n      height: 48,\n      minHeight: 0,\n    },\n  },\n  content: {\n    display: 'grid',\n    background: theme.palette.background.default,\n    gridTemplateColumns: '180px auto 1fr',\n    gridTemplateRows: '1fr',\n    padding: 0,\n    height: 400,\n  },\n}));\n\nexport function DryRunResults() {\n  const classes = useStyles();\n  const dryRun = useDryRun();\n  const [expanded, setExpanded] = useState(false);\n  const [hidden, setHidden] = useState(true);\n\n  const resultsLength = dryRun.results.length;\n  const prevResultsLength = usePrevious(resultsLength);\n  useEffect(() => {\n    if (prevResultsLength === 0 && resultsLength === 1) {\n      setHidden(false);\n      setExpanded(true);\n    } else if (prevResultsLength === 1 && resultsLength === 0) {\n      setExpanded(false);\n    }\n  }, [prevResultsLength, resultsLength]);\n\n  return (\n    <>\n      <Accordion\n        variant=\"outlined\"\n        expanded={expanded}\n        hidden={resultsLength === 0 && hidden}\n        onChange={(_, exp) => setExpanded(exp)}\n        onTransitionEnd={() => resultsLength === 0 && setHidden(true)}\n      >\n        <AccordionSummary\n          className={classes.header}\n          expandIcon={<ExpandMoreIcon />}\n        >\n          <Typography>Dry-run results</Typography>\n        </AccordionSummary>\n        <Divider orientation=\"horizontal\" />\n        <AccordionDetails className={classes.content}>\n          <DryRunResultsList />\n          <Divider orientation=\"horizontal\" />\n          <DryRunResultsView />\n        </AccordionDetails>\n      </Accordion>\n    </>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Divider, IconButton, makeStyles, Tooltip } from '@material-ui/core';\nimport CloseIcon from '@material-ui/icons/Close';\nimport RefreshIcon from '@material-ui/icons/Refresh';\nimport SaveIcon from '@material-ui/icons/Save';\nimport React from 'react';\nimport { FileBrowser } from '../FileBrowser';\nimport { useDirectoryEditor } from './DirectoryEditorContext';\n\nconst useStyles = makeStyles(theme => ({\n  button: {\n    padding: theme.spacing(1),\n  },\n  buttons: {\n    display: 'flex',\n    flexFlow: 'row nowrap',\n    alignItems: 'center',\n    justifyContent: 'flex-start',\n  },\n  buttonsGap: {\n    flex: '1 1 auto',\n  },\n  buttonsDivider: {\n    marginBottom: theme.spacing(1),\n  },\n}));\n\n/** The local file browser for the template editor */\nexport function TemplateEditorBrowser(props: { onClose?: () => void }) {\n  const classes = useStyles();\n  const directoryEditor = useDirectoryEditor();\n  const changedFiles = directoryEditor.files.filter(file => file.dirty);\n\n  const handleClose = () => {\n    if (!props.onClose) {\n      return;\n    }\n    if (changedFiles.length > 0) {\n      // eslint-disable-next-line no-alert\n      const accepted = window.confirm(\n        'Are you sure? Unsaved changes will be lost',\n      );\n      if (!accepted) {\n        return;\n      }\n    }\n    props.onClose();\n  };\n\n  return (\n    <>\n      <div className={classes.buttons}>\n        <Tooltip title=\"Save all files\">\n          <IconButton\n            className={classes.button}\n            disabled={directoryEditor.files.every(file => !file.dirty)}\n            onClick={() => directoryEditor.save()}\n          >\n            <SaveIcon />\n          </IconButton>\n        </Tooltip>\n        <Tooltip title=\"Reload directory\">\n          <IconButton\n            className={classes.button}\n            onClick={() => directoryEditor.reload()}\n          >\n            <RefreshIcon />\n          </IconButton>\n        </Tooltip>\n        <div className={classes.buttonsGap} />\n        <Tooltip title=\"Close directory\">\n          <IconButton className={classes.button} onClick={handleClose}>\n            <CloseIcon />\n          </IconButton>\n        </Tooltip>\n      </div>\n      <Divider className={classes.buttonsDivider} />\n      <FileBrowser\n        selected={directoryEditor.selectedFile?.path ?? ''}\n        onSelect={directoryEditor.setSelectedFile}\n        filePaths={directoryEditor.files.map(file => file.path)}\n      />\n    </>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useApiHolder } from '@backstage/core-plugin-api';\nimport { JsonObject, JsonValue } from '@backstage/types';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { Component, ReactNode, useMemo, useState } from 'react';\nimport useDebounce from 'react-use/lib/useDebounce';\nimport yaml from 'yaml';\nimport { FieldExtensionOptions } from '../../extensions';\nimport { LayoutOptions } from '../../layouts';\nimport { TemplateParameterSchema } from '../../types';\nimport { MultistepJsonForm } from '../MultistepJsonForm';\nimport { createValidator } from '../TemplatePage';\nimport { useDirectoryEditor } from './DirectoryEditorContext';\nimport { useDryRun } from './DryRunContext';\n\nconst useStyles = makeStyles({\n  containerWrapper: {\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n  },\n  container: {\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    overflow: 'auto',\n  },\n});\n\ninterface ErrorBoundaryProps {\n  invalidator: unknown;\n  setErrorText(errorText: string | undefined): void;\n  children: ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  shouldRender: boolean;\n}\n\nclass ErrorBoundary extends Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  state = {\n    shouldRender: true,\n  };\n\n  componentDidUpdate(prevProps: { invalidator: unknown }) {\n    if (prevProps.invalidator !== this.props.invalidator) {\n      this.setState({ shouldRender: true });\n    }\n  }\n\n  componentDidCatch(error: Error) {\n    this.props.setErrorText(error.message);\n    this.setState({ shouldRender: false });\n  }\n\n  render() {\n    return this.state.shouldRender ? this.props.children : null;\n  }\n}\n\ninterface TemplateEditorFormProps {\n  content?: string;\n  /** Setting this to true will cause the content to be parsed as if it is the template entity spec */\n  contentIsSpec?: boolean;\n  data: JsonObject;\n  onUpdate: (data: JsonObject) => void;\n  setErrorText: (errorText?: string) => void;\n\n  onDryRun?: (data: JsonObject) => Promise<void>;\n  fieldExtensions?: FieldExtensionOptions<any, any>[];\n  layouts?: LayoutOptions[];\n}\n\nfunction isJsonObject(value: JsonValue | undefined): value is JsonObject {\n  return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\n\n/** Shows the a template form that is parsed from the provided content */\nexport function TemplateEditorForm(props: TemplateEditorFormProps) {\n  const {\n    content,\n    contentIsSpec,\n    data,\n    onUpdate,\n    onDryRun,\n    setErrorText,\n    fieldExtensions = [],\n    layouts = [],\n  } = props;\n  const classes = useStyles();\n  const apiHolder = useApiHolder();\n\n  const [steps, setSteps] = useState<TemplateParameterSchema['steps']>();\n\n  const fields = useMemo(() => {\n    return Object.fromEntries(\n      fieldExtensions.map(({ name, component }) => [name, component]),\n    );\n  }, [fieldExtensions]);\n\n  useDebounce(\n    () => {\n      try {\n        if (!content) {\n          setSteps(undefined);\n          return;\n        }\n        const parsed: JsonValue = yaml.parse(content);\n\n        if (!isJsonObject(parsed)) {\n          setSteps(undefined);\n          return;\n        }\n\n        let rootObj = parsed;\n        if (!contentIsSpec) {\n          const isTemplate =\n            String(parsed.kind).toLocaleLowerCase('en-US') === 'template';\n          if (!isTemplate) {\n            setSteps(undefined);\n            return;\n          }\n\n          rootObj = isJsonObject(parsed.spec) ? parsed.spec : {};\n        }\n\n        const { parameters } = rootObj;\n\n        if (!Array.isArray(parameters)) {\n          setErrorText('Template parameters must be an array');\n          setSteps(undefined);\n          return;\n        }\n\n        const fieldValidators = Object.fromEntries(\n          fieldExtensions.map(({ name, validation }) => [name, validation]),\n        );\n\n        setErrorText();\n        setSteps(\n          parameters.flatMap(param =>\n            isJsonObject(param)\n              ? [\n                  {\n                    title: String(param.title),\n                    schema: param,\n                    validate: createValidator(param, fieldValidators, {\n                      apiHolder,\n                    }),\n                  },\n                ]\n              : [],\n          ),\n        );\n      } catch (e) {\n        setErrorText(e.message);\n      }\n    },\n    250,\n    [contentIsSpec, content, apiHolder],\n  );\n\n  if (!steps) {\n    return null;\n  }\n\n  return (\n    <div className={classes.containerWrapper}>\n      <div className={classes.container}>\n        <ErrorBoundary invalidator={steps} setErrorText={setErrorText}>\n          <MultistepJsonForm\n            steps={steps}\n            fields={fields}\n            formData={data}\n            onChange={e => onUpdate(e.formData)}\n            onReset={() => onUpdate({})}\n            finishButtonLabel={onDryRun && 'Try It'}\n            onFinish={onDryRun && (() => onDryRun(data))}\n            layouts={layouts}\n          />\n        </ErrorBoundary>\n      </div>\n    </div>\n  );\n}\n\n/** A version of the TemplateEditorForm that is connected to the DirectoryEditor and DryRun contexts */\nexport function TemplateEditorFormDirectoryEditorDryRun(\n  props: Pick<\n    TemplateEditorFormProps,\n    'setErrorText' | 'fieldExtensions' | 'layouts'\n  >,\n) {\n  const { setErrorText, fieldExtensions = [], layouts } = props;\n  const dryRun = useDryRun();\n\n  const directoryEditor = useDirectoryEditor();\n  const { selectedFile } = directoryEditor;\n\n  const [data, setData] = useState<JsonObject>({});\n\n  const handleDryRun = async () => {\n    if (!selectedFile) {\n      return;\n    }\n\n    try {\n      await dryRun.execute({\n        templateContent: selectedFile.content,\n        values: data,\n        files: directoryEditor.files,\n      });\n      setErrorText();\n    } catch (e) {\n      setErrorText(String(e.cause || e));\n      throw e;\n    }\n  };\n\n  const content =\n    selectedFile && selectedFile.path.match(/\\.ya?ml$/)\n      ? selectedFile.content\n      : undefined;\n\n  return (\n    <TemplateEditorForm\n      onDryRun={handleDryRun}\n      fieldExtensions={fieldExtensions}\n      setErrorText={setErrorText}\n      content={content}\n      data={data}\n      onUpdate={setData}\n      layouts={layouts}\n    />\n  );\n}\n\nTemplateEditorForm.DirectoryEditorDryRun =\n  TemplateEditorFormDirectoryEditorDryRun;\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StreamLanguage } from '@codemirror/language';\nimport { yaml as yamlSupport } from '@codemirror/legacy-modes/mode/yaml';\nimport { showPanel } from '@codemirror/view';\nimport { IconButton, makeStyles, Paper, Tooltip } from '@material-ui/core';\nimport RefreshIcon from '@material-ui/icons/Refresh';\nimport SaveIcon from '@material-ui/icons/Save';\nimport { useKeyboardEvent } from '@react-hookz/web';\nimport CodeMirror from '@uiw/react-codemirror';\nimport React, { useMemo } from 'react';\nimport { useDirectoryEditor } from './DirectoryEditorContext';\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n  },\n  codeMirror: {\n    position: 'absolute',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n  },\n  errorPanel: {\n    color: theme.palette.error.main,\n    lineHeight: 2,\n    margin: theme.spacing(0, 1),\n  },\n  floatingButtons: {\n    position: 'absolute',\n    top: theme.spacing(1),\n    right: theme.spacing(3),\n  },\n  floatingButton: {\n    padding: theme.spacing(1),\n  },\n}));\n\n/** A wrapper around CodeMirror with an error panel and extra actions available */\nexport function TemplateEditorTextArea(props: {\n  content?: string;\n  onUpdate?: (content: string) => void;\n  errorText?: string;\n  onSave?: () => void;\n  onReload?: () => void;\n}) {\n  const { errorText } = props;\n  const classes = useStyles();\n\n  const panelExtension = useMemo(() => {\n    if (!errorText) {\n      return showPanel.of(null);\n    }\n\n    const dom = document.createElement('div');\n    dom.classList.add(classes.errorPanel);\n    dom.textContent = errorText;\n    return showPanel.of(() => ({ dom, bottom: true }));\n  }, [classes, errorText]);\n\n  useKeyboardEvent(\n    e => e.key === 's' && (e.ctrlKey || e.metaKey),\n    e => {\n      e.preventDefault();\n      if (props.onSave) {\n        props.onSave();\n      }\n    },\n  );\n\n  return (\n    <div className={classes.container}>\n      <CodeMirror\n        className={classes.codeMirror}\n        theme=\"dark\"\n        height=\"100%\"\n        extensions={[StreamLanguage.define(yamlSupport), panelExtension]}\n        value={props.content}\n        onChange={props.onUpdate}\n      />\n      {(props.onSave || props.onReload) && (\n        <div className={classes.floatingButtons}>\n          <Paper>\n            {props.onSave && (\n              <Tooltip title=\"Save file\">\n                <IconButton\n                  className={classes.floatingButton}\n                  onClick={() => props.onSave?.()}\n                >\n                  <SaveIcon />\n                </IconButton>\n              </Tooltip>\n            )}\n            {props.onReload && (\n              <Tooltip title=\"Reload file\">\n                <IconButton\n                  className={classes.floatingButton}\n                  onClick={() => props.onReload?.()}\n                >\n                  <RefreshIcon />\n                </IconButton>\n              </Tooltip>\n            )}\n          </Paper>\n        </div>\n      )}\n    </div>\n  );\n}\n\n/** A version of the TemplateEditorTextArea that is connected to the DirectoryEditor context */\nexport function TemplateEditorDirectoryEditorTextArea(props: {\n  errorText?: string;\n}) {\n  const directoryEditor = useDirectoryEditor();\n\n  const actions = directoryEditor.selectedFile?.dirty\n    ? {\n        onSave: () => directoryEditor.save(),\n        onReload: () => directoryEditor.reload(),\n      }\n    : {\n        onReload: () => directoryEditor.reload(),\n      };\n\n  return (\n    <TemplateEditorTextArea\n      errorText={props.errorText}\n      content={directoryEditor.selectedFile?.content}\n      onUpdate={content => directoryEditor.selectedFile?.updateContent(content)}\n      {...actions}\n    />\n  );\n}\n\nTemplateEditorTextArea.DirectoryEditor = TemplateEditorDirectoryEditorTextArea;\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { makeStyles } from '@material-ui/core';\nimport React, { useState } from 'react';\nimport { FieldExtensionOptions } from '../../extensions';\nimport type { LayoutOptions } from '../../layouts';\nimport { TemplateDirectoryAccess } from '../../lib/filesystem';\nimport { DirectoryEditorProvider } from './DirectoryEditorContext';\nimport { DryRunProvider } from './DryRunContext';\nimport { DryRunResults } from './DryRunResults';\nimport { TemplateEditorBrowser } from './TemplateEditorBrowser';\nimport { TemplateEditorForm } from './TemplateEditorForm';\nimport { TemplateEditorTextArea } from './TemplateEditorTextArea';\n\nconst useStyles = makeStyles({\n  // Reset and fix sizing to make sure scrolling behaves correctly\n  root: {\n    gridArea: 'pageContent',\n\n    display: 'grid',\n    gridTemplateAreas: `\n      \"browser editor preview\"\n      \"results results results\"\n    `,\n    gridTemplateColumns: '1fr 3fr 2fr',\n    gridTemplateRows: '1fr auto',\n  },\n  browser: {\n    gridArea: 'browser',\n    overflow: 'auto',\n  },\n  editor: {\n    gridArea: 'editor',\n    overflow: 'auto',\n  },\n  preview: {\n    gridArea: 'preview',\n    overflow: 'auto',\n  },\n  results: {\n    gridArea: 'results',\n  },\n});\n\nexport const TemplateEditor = (props: {\n  directory: TemplateDirectoryAccess;\n  fieldExtensions?: FieldExtensionOptions<any, any>[];\n  layouts?: LayoutOptions[];\n  onClose?: () => void;\n}) => {\n  const classes = useStyles();\n\n  const [errorText, setErrorText] = useState<string>();\n\n  return (\n    <DirectoryEditorProvider directory={props.directory}>\n      <DryRunProvider>\n        <main className={classes.root}>\n          <section className={classes.browser}>\n            <TemplateEditorBrowser onClose={props.onClose} />\n          </section>\n          <section className={classes.editor}>\n            <TemplateEditorTextArea.DirectoryEditor errorText={errorText} />\n          </section>\n          <section className={classes.preview}>\n            <TemplateEditorForm.DirectoryEditorDryRun\n              setErrorText={setErrorText}\n              fieldExtensions={props.fieldExtensions}\n              layouts={props.layouts}\n            />\n          </section>\n          <section className={classes.results}>\n            <DryRunResults />\n          </section>\n        </main>\n      </DryRunProvider>\n    </DirectoryEditorProvider>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Entity } from '@backstage/catalog-model';\nimport { alertApiRef, useApi } from '@backstage/core-plugin-api';\nimport {\n  catalogApiRef,\n  humanizeEntityRef,\n} from '@backstage/plugin-catalog-react';\nimport {\n  FormControl,\n  IconButton,\n  InputLabel,\n  LinearProgress,\n  makeStyles,\n  MenuItem,\n  Select,\n} from '@material-ui/core';\nimport CloseIcon from '@material-ui/icons/Close';\nimport React, { useCallback, useState } from 'react';\nimport useAsync from 'react-use/lib/useAsync';\nimport yaml from 'yaml';\nimport { FieldExtensionOptions } from '../../extensions';\nimport { LayoutOptions } from '../../layouts';\nimport { TemplateEditorForm } from './TemplateEditorForm';\nimport { TemplateEditorTextArea } from './TemplateEditorTextArea';\n\nconst EXAMPLE_TEMPLATE_PARAMS_YAML = `# Edit the template parameters below to see how they will render in the scaffolder form UI\nparameters:\n  - title: Fill in some steps\n    required:\n      - name\n    properties:\n      name:\n        title: Name\n        type: string\n        description: Unique name of the component\n      owner:\n        title: Owner\n        type: string\n        description: Owner of the component\n        ui:field: OwnerPicker\n        ui:options:\n          allowedKinds:\n            - Group\n  - title: Choose a location\n    required:\n      - repoUrl\n    properties:\n      repoUrl:\n        title: Repository Location\n        type: string\n        ui:field: RepoUrlPicker\n        ui:options:\n          allowedHosts:\n            - github.com\nsteps:\n  - id: fetch-base\n    name: Fetch Base\n    action: fetch:template\n    input:\n      url: ./template\n      values:\n        name: \\${{parameters.name}}\n`;\n\ntype TemplateOption = {\n  label: string;\n  value: Entity;\n};\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    gridArea: 'pageContent',\n    display: 'grid',\n    gridTemplateAreas: `\n      \"controls controls\"\n      \"textArea preview\"\n    `,\n    gridTemplateRows: 'auto 1fr',\n    gridTemplateColumns: '1fr 1fr',\n  },\n  controls: {\n    gridArea: 'controls',\n    display: 'flex',\n    flexFlow: 'row nowrap',\n    alignItems: 'center',\n    margin: theme.spacing(1),\n  },\n  textArea: {\n    gridArea: 'textArea',\n  },\n  preview: {\n    gridArea: 'preview',\n  },\n}));\n\nexport const TemplateFormPreviewer = ({\n  defaultPreviewTemplate = EXAMPLE_TEMPLATE_PARAMS_YAML,\n  customFieldExtensions = [],\n  onClose,\n  layouts = [],\n}: {\n  defaultPreviewTemplate?: string;\n  customFieldExtensions?: FieldExtensionOptions<any, any>[];\n  onClose?: () => void;\n  layouts?: LayoutOptions[];\n}) => {\n  const classes = useStyles();\n  const alertApi = useApi(alertApiRef);\n  const catalogApi = useApi(catalogApiRef);\n  const [selectedTemplate, setSelectedTemplate] = useState('');\n  const [errorText, setErrorText] = useState<string>();\n  const [templateOptions, setTemplateOptions] = useState<TemplateOption[]>([]);\n  const [templateYaml, setTemplateYaml] = useState(defaultPreviewTemplate);\n  const [formState, setFormState] = useState({});\n\n  const { loading } = useAsync(\n    () =>\n      catalogApi\n        .getEntities({\n          filter: { kind: 'template' },\n          fields: [\n            'kind',\n            'metadata.namespace',\n            'metadata.name',\n            'metadata.title',\n            'spec.parameters',\n            'spec.steps',\n            'spec.output',\n          ],\n        })\n        .then(({ items }) =>\n          setTemplateOptions(\n            items.map(template => ({\n              label:\n                template.metadata.title ??\n                humanizeEntityRef(template, { defaultKind: 'template' }),\n              value: template,\n            })),\n          ),\n        )\n        .catch(e =>\n          alertApi.post({\n            message: `Error loading exisiting templates: ${e.message}`,\n            severity: 'error',\n          }),\n        ),\n    [catalogApi],\n  );\n\n  const handleSelectChange = useCallback(\n    selected => {\n      setSelectedTemplate(selected);\n      setTemplateYaml(yaml.stringify(selected.spec));\n    },\n    [setTemplateYaml],\n  );\n\n  return (\n    <>\n      {loading && <LinearProgress />}\n      <main className={classes.root}>\n        <div className={classes.controls}>\n          <FormControl variant=\"outlined\" size=\"small\" fullWidth>\n            <InputLabel id=\"select-template-label\">\n              Load Existing Template\n            </InputLabel>\n            <Select\n              value={selectedTemplate}\n              label=\"Load Existing Template\"\n              labelId=\"select-template-label\"\n              onChange={e => handleSelectChange(e.target.value)}\n            >\n              {templateOptions.map((option, idx) => (\n                <MenuItem key={idx} value={option.value as any}>\n                  {option.label}\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n\n          <IconButton size=\"medium\" onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </div>\n        <div className={classes.textArea}>\n          <TemplateEditorTextArea\n            content={templateYaml}\n            onUpdate={setTemplateYaml}\n            errorText={errorText}\n          />\n        </div>\n        <div className={classes.preview}>\n          <TemplateEditorForm\n            content={templateYaml}\n            contentIsSpec\n            fieldExtensions={customFieldExtensions}\n            data={formState}\n            onUpdate={setFormState}\n            setErrorText={setErrorText}\n            layouts={layouts}\n          />\n        </div>\n      </main>\n    </>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { useState } from 'react';\nimport { Content, Header, Page } from '@backstage/core-components';\nimport {\n  TemplateDirectoryAccess,\n  WebFileSystemAccess,\n} from '../../lib/filesystem';\nimport { TemplateEditorIntro } from './TemplateEditorIntro';\nimport { TemplateEditor } from './TemplateEditor';\nimport { TemplateFormPreviewer } from './TemplateFormPreviewer';\nimport { FieldExtensionOptions } from '../../extensions';\nimport type { LayoutOptions } from '../../layouts';\n\ntype Selection =\n  | {\n      type: 'local';\n      directory: TemplateDirectoryAccess;\n    }\n  | {\n      type: 'form';\n    };\n\ninterface TemplateEditorPageProps {\n  defaultPreviewTemplate?: string;\n  customFieldExtensions?: FieldExtensionOptions<any, any>[];\n  layouts?: LayoutOptions[];\n}\n\nexport function TemplateEditorPage(props: TemplateEditorPageProps) {\n  const [selection, setSelection] = useState<Selection>();\n\n  let content: JSX.Element | null = null;\n  if (selection?.type === 'local') {\n    content = (\n      <TemplateEditor\n        directory={selection.directory}\n        fieldExtensions={props.customFieldExtensions}\n        onClose={() => setSelection(undefined)}\n        layouts={props.layouts}\n      />\n    );\n  } else if (selection?.type === 'form') {\n    content = (\n      <TemplateFormPreviewer\n        defaultPreviewTemplate={props.defaultPreviewTemplate}\n        customFieldExtensions={props.customFieldExtensions}\n        onClose={() => setSelection(undefined)}\n        layouts={props.layouts}\n      />\n    );\n  } else {\n    content = (\n      <Content>\n        <TemplateEditorIntro\n          onSelect={option => {\n            if (option === 'local') {\n              WebFileSystemAccess.requestDirectoryAccess()\n                .then(directory => setSelection({ type: 'local', directory }))\n                .catch(() => {});\n            } else if (option === 'form') {\n              setSelection({ type: 'form' });\n            }\n          }}\n        />\n      </Content>\n    );\n  }\n\n  return (\n    <Page themeId=\"home\">\n      <Header\n        title=\"Template Editor\"\n        subtitle=\"Edit, preview, and try out templates and template forms\"\n      />\n      {content}\n    </Page>\n  );\n}\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { IconComponent } from '@backstage/core-plugin-api';\nimport {\n  Card,\n  List,\n  ListItemIcon,\n  ListItemText,\n  makeStyles,\n  MenuItem,\n  Theme,\n  Typography,\n} from '@material-ui/core';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport React, { Fragment } from 'react';\n\nimport AllIcon from '@material-ui/icons/FontDownload';\n\nconst useStyles = makeStyles<Theme>(\n  theme => ({\n    root: {\n      backgroundColor: 'rgba(0, 0, 0, .11)',\n      boxShadow: 'none',\n      margin: theme.spacing(1, 0, 1, 0),\n    },\n    title: {\n      margin: theme.spacing(1, 0, 0, 1),\n      textTransform: 'uppercase',\n      fontSize: 12,\n      fontWeight: 'bold',\n    },\n    listIcon: {\n      minWidth: 30,\n      color: theme.palette.text.primary,\n    },\n    menuItem: {\n      minHeight: theme.spacing(6),\n    },\n    groupWrapper: {\n      margin: theme.spacing(1, 1, 2, 1),\n    },\n  }),\n  {\n    name: 'ScaffolderReactOwnerListPicker',\n  },\n);\n\nexport type ButtonGroup = {\n  name: string;\n  items: {\n    id: 'owned' | 'starred' | 'all';\n    label: string;\n    icon?: IconComponent;\n  }[];\n};\n\nfunction getFilterGroups(): ButtonGroup[] {\n  return [\n    {\n      name: 'Task Owner',\n      items: [\n        {\n          id: 'owned',\n          label: 'Owned',\n          icon: SettingsIcon,\n        },\n        {\n          id: 'all',\n          label: 'All',\n          icon: AllIcon,\n        },\n      ],\n    },\n  ];\n}\n\nexport const OwnerListPicker = (props: {\n  filter: string;\n  onSelectOwner: (id: 'owned' | 'all') => void;\n}) => {\n  const { filter, onSelectOwner } = props;\n  const classes = useStyles();\n\n  const filterGroups = getFilterGroups();\n  return (\n    <Card className={classes.root}>\n      {filterGroups.map(group => (\n        <Fragment key={group.name}>\n          <Typography variant=\"subtitle2\" className={classes.title}>\n            {group.name}\n          </Typography>\n          <Card className={classes.groupWrapper}>\n            <List disablePadding dense>\n              {group.items.map(item => (\n                <MenuItem\n                  key={item.id}\n                  button\n                  divider\n                  onClick={() => onSelectOwner(item.id as 'owned' | 'all')}\n                  selected={item.id === filter}\n                  className={classes.menuItem}\n                  data-testid={`owner-picker-${item.id}`}\n                >\n                  {item.icon && (\n                    <ListItemIcon className={classes.listIcon}>\n                      <item.icon fontSize=\"small\" />\n                    </ListItemIcon>\n                  )}\n                  <ListItemText>\n                    <Typography variant=\"body1\">{item.label}</Typography>\n                  </ListItemText>\n                </MenuItem>\n              ))}\n            </List>\n          </Card>\n        </Fragment>\n      ))}\n    </Card>\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DateTime, Interval } from 'luxon';\nimport humanizeDuration from 'humanize-duration';\nimport React from 'react';\n\nexport const CreatedAtColumn = ({ createdAt }: { createdAt: string }) => {\n  const createdAtTime = DateTime.fromISO(createdAt);\n  const formatted = Interval.fromDateTimes(createdAtTime, DateTime.local())\n    .toDuration()\n    .valueOf();\n\n  return <p>{humanizeDuration(formatted, { round: true })} ago</p>;\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useApi } from '@backstage/core-plugin-api';\nimport React from 'react';\n\nimport useAsync from 'react-use/lib/useAsync';\n\nimport { catalogApiRef, EntityRefLink } from '@backstage/plugin-catalog-react';\nimport { parseEntityRef, UserEntity } from '@backstage/catalog-model';\n\nexport const OwnerEntityColumn = ({ entityRef }: { entityRef?: string }) => {\n  const catalogApi = useApi(catalogApiRef);\n\n  const { value, loading, error } = useAsync(\n    () => catalogApi.getEntityByRef(entityRef || ''),\n    [catalogApi, entityRef],\n  );\n\n  if (!entityRef) {\n    return <p>Unknown</p>;\n  }\n\n  if (loading || error) {\n    return null;\n  }\n\n  return (\n    <EntityRefLink\n      entityRef={parseEntityRef(entityRef)}\n      title={\n        (value as UserEntity)?.spec?.profile?.displayName ??\n        value?.metadata.name\n      }\n    />\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  StatusError,\n  StatusOK,\n  StatusPending,\n} from '@backstage/core-components';\nimport React from 'react';\n\nexport const TaskStatusColumn = ({ status }: { status: string }) => {\n  switch (status) {\n    case 'processing':\n      return <StatusPending>{status}</StatusPending>;\n    case 'completed':\n      return <StatusOK>{status}</StatusOK>;\n    case 'error':\n    default:\n      return <StatusError>{status}</StatusError>;\n  }\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useApi } from '@backstage/core-plugin-api';\nimport React from 'react';\nimport { scaffolderApiRef } from '../../../api';\nimport useAsync from 'react-use/lib/useAsync';\nimport { parseEntityRef } from '@backstage/catalog-model';\nimport { EntityRefLink } from '@backstage/plugin-catalog-react';\n\nexport const TemplateTitleColumn = ({ entityRef }: { entityRef?: string }) => {\n  const scaffolder = useApi(scaffolderApiRef);\n  const { value, loading, error } = useAsync(\n    () => scaffolder.getTemplateParameterSchema(entityRef || ''),\n    [scaffolder, entityRef],\n  );\n\n  if (loading || error || !entityRef) {\n    return null;\n  }\n\n  return (\n    <EntityRefLink entityRef={parseEntityRef(entityRef)} title={value?.title} />\n  );\n};\n","/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  Content,\n  EmptyState,\n  ErrorPanel,\n  Header,\n  Lifecycle,\n  Link,\n  Page,\n  Progress,\n  Table,\n} from '@backstage/core-components';\nimport { useApi, useRouteRef } from '@backstage/core-plugin-api';\nimport { CatalogFilterLayout } from '@backstage/plugin-catalog-react';\nimport useAsync from 'react-use/lib/useAsync';\nimport React, { useState } from 'react';\nimport { scaffolderApiRef } from '../../api';\nimport { rootRouteRef } from '../../routes';\nimport { ScaffolderTask } from '../../types';\nimport { OwnerListPicker } from './OwnerListPicker';\nimport {\n  CreatedAtColumn,\n  OwnerEntityColumn,\n  TaskStatusColumn,\n  TemplateTitleColumn,\n} from './columns';\n\nexport interface MyTaskPageProps {\n  initiallySelectedFilter?: 'owned' | 'all';\n}\n\nconst ListTaskPageContent = (props: MyTaskPageProps) => {\n  const { initiallySelectedFilter = 'owned' } = props;\n\n  const scaffolderApi = useApi(scaffolderApiRef);\n  const rootLink = useRouteRef(rootRouteRef);\n\n  const [ownerFilter, setOwnerFilter] = useState(initiallySelectedFilter);\n  const { value, loading, error } = useAsync(() => {\n    if (scaffolderApi.listTasks) {\n      return scaffolderApi.listTasks?.({ filterByOwnership: ownerFilter });\n    }\n\n    // eslint-disable-next-line no-console\n    console.warn(\n      'listTasks is not implemented in the scaffolderApi, please make sure to implement this method.',\n    );\n\n    return Promise.resolve({ tasks: [] });\n  }, [scaffolderApi, ownerFilter]);\n\n  if (loading) {\n    return <Progress />;\n  }\n\n  if (error) {\n    return (\n      <>\n        <ErrorPanel error={error} />\n        <EmptyState\n          missing=\"info\"\n          title=\"No information to display\"\n          description=\"There is no Tasks or there was an issue communicating with backend.\"\n        />\n      </>\n    );\n  }\n\n  return (\n    <CatalogFilterLayout>\n      <CatalogFilterLayout.Filters>\n        <OwnerListPicker\n          filter={ownerFilter}\n          onSelectOwner={id => setOwnerFilter(id)}\n        />\n      </CatalogFilterLayout.Filters>\n      <CatalogFilterLayout.Content>\n        <Table<ScaffolderTask>\n          data={value?.tasks ?? []}\n          title=\"Tasks\"\n          columns={[\n            {\n              title: 'Task ID',\n              field: 'id',\n              render: row => (\n                <Link to={`${rootLink()}/tasks/${row.id}`}>{row.id}</Link>\n              ),\n            },\n            {\n              title: 'Template',\n              render: row => (\n                <TemplateTitleColumn\n                  entityRef={row.spec.templateInfo?.entityRef}\n                />\n              ),\n            },\n            {\n              title: 'Created',\n              field: 'createdAt',\n              render: row => <CreatedAtColumn createdAt={row.createdAt} />,\n            },\n            {\n              title: 'Owner',\n              field: 'createdBy',\n              render: row => (\n                <OwnerEntityColumn entityRef={row.spec?.user?.ref} />\n              ),\n            },\n            {\n              title: 'Status',\n              field: 'status',\n              render: row => <TaskStatusColumn status={row.status} />,\n            },\n          ]}\n        />\n      </CatalogFilterLayout.Content>\n    </CatalogFilterLayout>\n  );\n};\n\nexport const ListTasksPage = (props: MyTaskPageProps) => {\n  return (\n    <Page themeId=\"home\">\n      <Header\n        pageTitleOverride=\"Templates Tasks\"\n        title={\n          <>\n            List template tasks <Lifecycle shorthand alpha />\n          </>\n        }\n        subtitle=\"All tasks that have been started\"\n      />\n      <Content>\n        <ListTaskPageContent {...props} />\n      </Content>\n    </Page>\n  );\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ComponentType, useEffect } from 'react';\nimport { Routes, Route, useOutlet, Navigate } from 'react-router';\nimport { Entity } from '@backstage/catalog-model';\nimport { TemplateEntityV1beta3 } from '@backstage/plugin-scaffolder-common';\nimport { ScaffolderPage } from './ScaffolderPage';\nimport { TemplatePage } from './TemplatePage';\nimport { TaskPage } from './TaskPage';\nimport { ActionsPage } from './ActionsPage';\nimport { SecretsContextProvider } from './secrets/SecretsContext';\nimport { TemplateEditorPage } from './TemplateEditorPage';\n\nimport {\n  FieldExtensionOptions,\n  FIELD_EXTENSION_WRAPPER_KEY,\n  FIELD_EXTENSION_KEY,\n  DEFAULT_SCAFFOLDER_FIELD_EXTENSIONS,\n} from '../extensions';\nimport {\n  useElementFilter,\n  useRouteRef,\n  useRouteRefParams,\n} from '@backstage/core-plugin-api';\nimport {\n  actionsRouteRef,\n  editRouteRef,\n  legacySelectedTemplateRouteRef,\n  scaffolderListTaskRouteRef,\n  scaffolderTaskRouteRef,\n  selectedTemplateRouteRef,\n} from '../routes';\nimport { ListTasksPage } from './ListTasksPage';\nimport { LayoutOptions, LAYOUTS_KEY, LAYOUTS_WRAPPER_KEY } from '../layouts';\n\n/**\n * The props for the entrypoint `ScaffolderPage` component the plugin.\n * @public\n */\nexport type RouterProps = {\n  components?: {\n    TemplateCardComponent?:\n      | ComponentType<{ template: TemplateEntityV1beta3 }>\n      | undefined;\n    TaskPageComponent?: ComponentType<{}>;\n  };\n  groups?: Array<{\n    title?: React.ReactNode;\n    filter: (entity: Entity) => boolean;\n  }>;\n  defaultPreviewTemplate?: string;\n  headerOptions?: {\n    pageTitleOverride?: string;\n    title?: string;\n    subtitle?: string;\n  };\n  /**\n   * Options for the context menu on the scaffolder page.\n   */\n  contextMenu?: {\n    /** Whether to show a link to the template editor */\n    editor?: boolean;\n    /** Whether to show a link to the actions documentation */\n    actions?: boolean;\n  };\n};\n\n/**\n * The main entrypoint `Router` for the `ScaffolderPlugin`.\n *\n * @public\n */\nexport const Router = (props: RouterProps) => {\n  const { groups, components = {}, defaultPreviewTemplate } = props;\n\n  const { TemplateCardComponent, TaskPageComponent } = components;\n\n  const outlet = useOutlet();\n  const TaskPageElement = TaskPageComponent ?? TaskPage;\n\n  const customFieldExtensions = useElementFilter(outlet, elements =>\n    elements\n      .selectByComponentData({\n        key: FIELD_EXTENSION_WRAPPER_KEY,\n      })\n      .findComponentData<FieldExtensionOptions>({\n        key: FIELD_EXTENSION_KEY,\n      }),\n  );\n\n  const fieldExtensions = [\n    ...customFieldExtensions,\n    ...DEFAULT_SCAFFOLDER_FIELD_EXTENSIONS.filter(\n      ({ name }) =>\n        !customFieldExtensions.some(\n          customFieldExtension => customFieldExtension.name === name,\n        ),\n    ),\n  ];\n\n  const customLayouts = useElementFilter(outlet, elements =>\n    elements\n      .selectByComponentData({\n        key: LAYOUTS_WRAPPER_KEY,\n      })\n      .findComponentData<LayoutOptions>({\n        key: LAYOUTS_KEY,\n      }),\n  );\n\n  /**\n   * This component can be deleted once the older routes have been deprecated.\n   */\n  const RedirectingComponent = () => {\n    const { templateName } = useRouteRefParams(legacySelectedTemplateRouteRef);\n    const newLink = useRouteRef(selectedTemplateRouteRef);\n    useEffect(\n      () =>\n        // eslint-disable-next-line no-console\n        console.warn(\n          'The route /template/:templateName is deprecated, please use the new /template/:namespace/:templateName route instead',\n        ),\n      [],\n    );\n    return <Navigate to={newLink({ namespace: 'default', templateName })} />;\n  };\n\n  return (\n    <Routes>\n      <Route\n        path=\"/\"\n        element={\n          <ScaffolderPage\n            groups={groups}\n            TemplateCardComponent={TemplateCardComponent}\n            contextMenu={props.contextMenu}\n            headerOptions={props.headerOptions}\n          />\n        }\n      />\n      <Route\n        path={legacySelectedTemplateRouteRef.path}\n        element={<RedirectingComponent />}\n      />\n      <Route\n        path={selectedTemplateRouteRef.path}\n        element={\n          <SecretsContextProvider>\n            <TemplatePage\n              customFieldExtensions={fieldExtensions}\n              layouts={customLayouts}\n            />\n          </SecretsContextProvider>\n        }\n      />\n      <Route\n        path={scaffolderListTaskRouteRef.path}\n        element={<ListTasksPage />}\n      />\n      <Route path={scaffolderTaskRouteRef.path} element={<TaskPageElement />} />\n      <Route path={actionsRouteRef.path} element={<ActionsPage />} />\n      <Route\n        path={editRouteRef.path}\n        element={\n          <SecretsContextProvider>\n            <TemplateEditorPage\n              defaultPreviewTemplate={defaultPreviewTemplate}\n              customFieldExtensions={fieldExtensions}\n              layouts={customLayouts}\n            />\n          </SecretsContextProvider>\n        }\n      />\n\n      <Route path=\"preview\" element={<Navigate to=\"../edit\" />} />\n    </Routes>\n  );\n};\n"],"names":["useStyles","_a","makeStyles","IconButton","isObject","MuiTheme","StepUI","Button","Card","CardContent","Typography","Tooltip","_access","_signalUpdate","useAsync","List","CancelIcon","CheckIcon","yamlSupport","_b","Box","ExpandMoreIcon","Divider","MenuItem","ListItemIcon","ListItemText","Table"],"mappings":"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"}